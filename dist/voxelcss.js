"use strict";var _slicedToArray=function(){function t(t,e){var r=[],a=!0,n=!1,o=void 0;try{for(var i,s=t[Symbol.iterator]();!(a=(i=s.next()).done)&&(r.push(i.value),!(e&&r.length===e));a=!0);}catch(t){n=!0,o=t}finally{try{!a&&s["return"]&&s["return"]()}finally{if(n)throw o}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};(function(t){if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window,e.voxelcss=t()}})(function(){var t=Math.PI;return function m(c,t,e){function r(i,o){if(!t[i]){if(!c[i]){var s="function"==typeof require&&require;if(!o&&s)return s(i,!0);if(n)return n(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var x=t[i]={exports:{}};c[i][0].call(x.exports,function(t){var e=c[i][1][t];return r(e?e:t)},x,x.exports,m,c,t,e)}return t[i].exports}for(var n="function"==typeof require&&require,a=0;a<e.length;a++)r(e[a]);return r}({1:[function(t,e){var r=".scene {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-perspective: 1000px;\n  perspective: 1000px;\n  -webkit-perspective-origin: 50% 50%;\n  perspective-origin: 50% 50%;\n  cursor: move;\n}\n.scene .camera,\n.scene .zoom {\n  top: 50%;\n  left: 50%;\n  width: 0;\n  height: 0;\n  overflow: visible;\n}\n.cube,\n.scene .camera,\n.scene .zoom {\n  position: absolute;\n  -webkit-transform-style: preserve-3d;\n  transform-style: preserve-3d;\n}\n.cube:hover img {\n  visibility: hidden!important;\n}\n.cube:hover .face {\n  background: rgba(0,0,0,.3)!important;\n}\n.cube:hover .face .shader {\n  opacity: 0!important;\n}\n.cube .anim {\n  -webkit-transform-style: preserve-3d;\n  transform-style: preserve-3d;\n}\n.cube .anim.down {\n  -webkit-animation: b 1s linear both;\n  animation: b 1s linear both;\n}\n.cube .anim.up {\n  -webkit-animation: a 1s linear both;\n  animation: a 1s linear both;\n}\n.face {\n  display: block;\n  position: absolute;\n  outline: none;\n  border: none;\n  margin-left: -18px;\n  margin-top: -18px;\n  width: 36px;\n  height: 36px;\n  cursor: pointer;\n}\n.face img {\n  width: 100%;\n  height: 100%;\n}\n.face img.colored {\n  visibility: hidden;\n}\n.face .shader {\n  display: block;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: #000;\n  opacity: 0;\n}\n@-webkit-keyframes a {\n  0% {\n    opacity: 0;\n    -webkit-transform: matrix(1,0,0,1,0,300);\n    transform: matrix(1,0,0,1,0,300);\n  }\n\n  1.3% {\n    -webkit-transform: matrix(1,0,0,3.905,0,237.02);\n    transform: matrix(1,0,0,3.905,0,237.02);\n  }\n\n  2.55% {\n    -webkit-transform: matrix(1,0,0,4.554,0,182.798);\n    transform: matrix(1,0,0,4.554,0,182.798);\n  }\n\n  4.1% {\n    -webkit-transform: matrix(1,0,0,4.025,0,125.912);\n    transform: matrix(1,0,0,4.025,0,125.912);\n  }\n\n  5.71% {\n    -webkit-transform: matrix(1,0,0,3.039,0,79.596);\n    transform: matrix(1,0,0,3.039,0,79.596);\n  }\n\n  8.11% {\n    opacity: 1;\n    -webkit-transform: matrix(1,0,0,1.82,0,31.647);\n    transform: matrix(1,0,0,1.82,0,31.647);\n  }\n\n  8.81% {\n    -webkit-transform: matrix(1,0,0,1.581,0,21.84);\n    transform: matrix(1,0,0,1.581,0,21.84);\n  }\n\n  11.96% {\n    -webkit-transform: matrix(1,0,0,1.034,0,-4.825);\n    transform: matrix(1,0,0,1.034,0,-4.825);\n  }\n\n  12.11% {\n    -webkit-transform: matrix(1,0,0,1.023,0,-5.53);\n    transform: matrix(1,0,0,1.023,0,-5.53);\n  }\n\n  15.07% {\n    -webkit-transform: matrix(1,0,0,.947,0,-12.662);\n    transform: matrix(1,0,0,.947,0,-12.662);\n  }\n\n  16.12% {\n    -webkit-transform: matrix(1,0,0,.951,0,-13.007);\n    transform: matrix(1,0,0,.951,0,-13.007);\n  }\n\n  27.23% {\n    -webkit-transform: matrix(1,0,0,1.001,0,-2.352);\n    transform: matrix(1,0,0,1.001,0,-2.352);\n  }\n\n  27.58% {\n    -webkit-transform: matrix(1,0,0,1.001,0,-2.121);\n    transform: matrix(1,0,0,1.001,0,-2.121);\n  }\n\n  38.34% {\n    -webkit-transform: matrix(1,0,0,1,0,.311);\n    transform: matrix(1,0,0,1,0,.311);\n  }\n\n  40.09% {\n    -webkit-transform: matrix(1,0,0,1,0,.291);\n    transform: matrix(1,0,0,1,0,.291);\n  }\n\n  50% {\n    -webkit-transform: matrix(1,0,0,1,0,.048);\n    transform: matrix(1,0,0,1,0,.048);\n  }\n\n  60.56% {\n    -webkit-transform: matrix(1,0,0,1,0,-.007);\n    transform: matrix(1,0,0,1,0,-.007);\n  }\n\n  82.78% {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n\n  to {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n}\n@keyframes a {\n  0% {\n    opacity: 0;\n    -webkit-transform: matrix(1,0,0,1,0,300);\n    transform: matrix(1,0,0,1,0,300);\n  }\n\n  1.3% {\n    -webkit-transform: matrix(1,0,0,3.905,0,237.02);\n    transform: matrix(1,0,0,3.905,0,237.02);\n  }\n\n  2.55% {\n    -webkit-transform: matrix(1,0,0,4.554,0,182.798);\n    transform: matrix(1,0,0,4.554,0,182.798);\n  }\n\n  4.1% {\n    -webkit-transform: matrix(1,0,0,4.025,0,125.912);\n    transform: matrix(1,0,0,4.025,0,125.912);\n  }\n\n  5.71% {\n    -webkit-transform: matrix(1,0,0,3.039,0,79.596);\n    transform: matrix(1,0,0,3.039,0,79.596);\n  }\n\n  8.11% {\n    opacity: 1;\n    -webkit-transform: matrix(1,0,0,1.82,0,31.647);\n    transform: matrix(1,0,0,1.82,0,31.647);\n  }\n\n  8.81% {\n    -webkit-transform: matrix(1,0,0,1.581,0,21.84);\n    transform: matrix(1,0,0,1.581,0,21.84);\n  }\n\n  11.96% {\n    -webkit-transform: matrix(1,0,0,1.034,0,-4.825);\n    transform: matrix(1,0,0,1.034,0,-4.825);\n  }\n\n  12.11% {\n    -webkit-transform: matrix(1,0,0,1.023,0,-5.53);\n    transform: matrix(1,0,0,1.023,0,-5.53);\n  }\n\n  15.07% {\n    -webkit-transform: matrix(1,0,0,.947,0,-12.662);\n    transform: matrix(1,0,0,.947,0,-12.662);\n  }\n\n  16.12% {\n    -webkit-transform: matrix(1,0,0,.951,0,-13.007);\n    transform: matrix(1,0,0,.951,0,-13.007);\n  }\n\n  27.23% {\n    -webkit-transform: matrix(1,0,0,1.001,0,-2.352);\n    transform: matrix(1,0,0,1.001,0,-2.352);\n  }\n\n  27.58% {\n    -webkit-transform: matrix(1,0,0,1.001,0,-2.121);\n    transform: matrix(1,0,0,1.001,0,-2.121);\n  }\n\n  38.34% {\n    -webkit-transform: matrix(1,0,0,1,0,.311);\n    transform: matrix(1,0,0,1,0,.311);\n  }\n\n  40.09% {\n    -webkit-transform: matrix(1,0,0,1,0,.291);\n    transform: matrix(1,0,0,1,0,.291);\n  }\n\n  50% {\n    -webkit-transform: matrix(1,0,0,1,0,.048);\n    transform: matrix(1,0,0,1,0,.048);\n  }\n\n  60.56% {\n    -webkit-transform: matrix(1,0,0,1,0,-.007);\n    transform: matrix(1,0,0,1,0,-.007);\n  }\n\n  82.78% {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n\n  to {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n}\n@-webkit-keyframes b {\n  0% {\n    opacity: 0;\n    -webkit-transform: matrix(1,0,0,1,0,-300);\n    transform: matrix(1,0,0,1,0,-300);\n  }\n\n  1.3% {\n    -webkit-transform: matrix(1,0,0,3.905,0,-237.02);\n    transform: matrix(1,0,0,3.905,0,-237.02);\n  }\n\n  2.55% {\n    -webkit-transform: matrix(1,0,0,4.554,0,-182.798);\n    transform: matrix(1,0,0,4.554,0,-182.798);\n  }\n\n  4.1% {\n    -webkit-transform: matrix(1,0,0,4.025,0,-125.912);\n    transform: matrix(1,0,0,4.025,0,-125.912);\n  }\n\n  5.71% {\n    -webkit-transform: matrix(1,0,0,3.039,0,-79.596);\n    transform: matrix(1,0,0,3.039,0,-79.596);\n  }\n\n  8.11% {\n    opacity: 1;\n    -webkit-transform: matrix(1,0,0,1.82,0,-31.647);\n    transform: matrix(1,0,0,1.82,0,-31.647);\n  }\n\n  8.81% {\n    -webkit-transform: matrix(1,0,0,1.581,0,-21.84);\n    transform: matrix(1,0,0,1.581,0,-21.84);\n  }\n\n  11.96% {\n    -webkit-transform: matrix(1,0,0,1.034,0,4.825);\n    transform: matrix(1,0,0,1.034,0,4.825);\n  }\n\n  12.11% {\n    -webkit-transform: matrix(1,0,0,1.023,0,5.53);\n    transform: matrix(1,0,0,1.023,0,5.53);\n  }\n\n  15.07% {\n    -webkit-transform: matrix(1,0,0,.947,0,12.662);\n    transform: matrix(1,0,0,.947,0,12.662);\n  }\n\n  16.12% {\n    -webkit-transform: matrix(1,0,0,.951,0,13.007);\n    transform: matrix(1,0,0,.951,0,13.007);\n  }\n\n  27.23% {\n    -webkit-transform: matrix(1,0,0,1.001,0,2.352);\n    transform: matrix(1,0,0,1.001,0,2.352);\n  }\n\n  27.58% {\n    -webkit-transform: matrix(1,0,0,1.001,0,2.121);\n    transform: matrix(1,0,0,1.001,0,2.121);\n  }\n\n  38.34% {\n    -webkit-transform: matrix(1,0,0,1,0,-.311);\n    transform: matrix(1,0,0,1,0,-.311);\n  }\n\n  40.09% {\n    -webkit-transform: matrix(1,0,0,1,0,-.291);\n    transform: matrix(1,0,0,1,0,-.291);\n  }\n\n  50% {\n    -webkit-transform: matrix(1,0,0,1,0,-.048);\n    transform: matrix(1,0,0,1,0,-.048);\n  }\n\n  60.56% {\n    -webkit-transform: matrix(1,0,0,1,0,.007);\n    transform: matrix(1,0,0,1,0,.007);\n  }\n\n  82.78% {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n\n  to {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n}\n@keyframes b {\n  0% {\n    opacity: 0;\n    -webkit-transform: matrix(1,0,0,1,0,-300);\n    transform: matrix(1,0,0,1,0,-300);\n  }\n\n  1.3% {\n    -webkit-transform: matrix(1,0,0,3.905,0,-237.02);\n    transform: matrix(1,0,0,3.905,0,-237.02);\n  }\n\n  2.55% {\n    -webkit-transform: matrix(1,0,0,4.554,0,-182.798);\n    transform: matrix(1,0,0,4.554,0,-182.798);\n  }\n\n  4.1% {\n    -webkit-transform: matrix(1,0,0,4.025,0,-125.912);\n    transform: matrix(1,0,0,4.025,0,-125.912);\n  }\n\n  5.71% {\n    -webkit-transform: matrix(1,0,0,3.039,0,-79.596);\n    transform: matrix(1,0,0,3.039,0,-79.596);\n  }\n\n  8.11% {\n    opacity: 1;\n    -webkit-transform: matrix(1,0,0,1.82,0,-31.647);\n    transform: matrix(1,0,0,1.82,0,-31.647);\n  }\n\n  8.81% {\n    -webkit-transform: matrix(1,0,0,1.581,0,-21.84);\n    transform: matrix(1,0,0,1.581,0,-21.84);\n  }\n\n  11.96% {\n    -webkit-transform: matrix(1,0,0,1.034,0,4.825);\n    transform: matrix(1,0,0,1.034,0,4.825);\n  }\n\n  12.11% {\n    -webkit-transform: matrix(1,0,0,1.023,0,5.53);\n    transform: matrix(1,0,0,1.023,0,5.53);\n  }\n\n  15.07% {\n    -webkit-transform: matrix(1,0,0,.947,0,12.662);\n    transform: matrix(1,0,0,.947,0,12.662);\n  }\n\n  16.12% {\n    -webkit-transform: matrix(1,0,0,.951,0,13.007);\n    transform: matrix(1,0,0,.951,0,13.007);\n  }\n\n  27.23% {\n    -webkit-transform: matrix(1,0,0,1.001,0,2.352);\n    transform: matrix(1,0,0,1.001,0,2.352);\n  }\n\n  27.58% {\n    -webkit-transform: matrix(1,0,0,1.001,0,2.121);\n    transform: matrix(1,0,0,1.001,0,2.121);\n  }\n\n  38.34% {\n    -webkit-transform: matrix(1,0,0,1,0,-.311);\n    transform: matrix(1,0,0,1,0,-.311);\n  }\n\n  40.09% {\n    -webkit-transform: matrix(1,0,0,1,0,-.291);\n    transform: matrix(1,0,0,1,0,-.291);\n  }\n\n  50% {\n    -webkit-transform: matrix(1,0,0,1,0,-.048);\n    transform: matrix(1,0,0,1,0,-.048);\n  }\n\n  60.56% {\n    -webkit-transform: matrix(1,0,0,1,0,.007);\n    transform: matrix(1,0,0,1,0,.007);\n  }\n\n  82.78% {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n\n  to {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n}\n";t("browserify-css").createStyle(r,{href:"dist/voxelcss.css"},{insertAt:"bottom"}),e.exports=r},{"browserify-css":15}],2:[function(t,e){"use strict";function r(){function t(){return 1===arguments.length&&arguments[0].constructor!==Number?arguments[0].constructor===String?m(arguments[0]):s(arguments[0]):a.apply(this,arguments)}function e(){return x}function a(t,r,n,o){var a=e();return void 0!==t&&t.constructor===Number&&(x.r=t),void 0!==r&&r.constructor===Number&&(x.g=r),void 0!==n&&n.constructor===Number&&(x.b=n),void 0!==o&&o.constructor===Number&&(x.a=o),c(),a}function s(t){return a(t.r,t.g,t.b,t.a)}function m(t){return x=n(t),x.a=1,c(),e()}function c(){l.triggerEvent("change",{target:l})}var l=this,x={r:0,g:0,b:0,a:1};Object.assign(l,{setColor:t,getColor:e,getHex:function getHex(){return o(x.r,x.g,x.b)},serialize:function serialize(){return JSON.stringify(x)},clone:function clone(){return new r(x)}}),function(){i(l),t.apply(this,arguments)}.apply(l,arguments)}var a=t("./common"),n=a.hexToRgb,o=a.rgbToHex,i=t("./eventListener");e.exports=r,r.loadFromSerial=function(t){var e=JSON.parse(t);return new r(e)}},{"./common":10,"./eventListener":11}],3:[function(t,e){"use strict";e.exports=function(){function t(){v=!0}function e(){f.save()}function r(t){n(t);var r=f.add(t);return v&&e(),r}function a(t){var r=f.remove(t);return r&&o(t),v&&e(),r}function n(t){t.addEventListener("VoxelClick",i),t.addEventListener("TopClick",s),t.addEventListener("BottomClick",m),t.addEventListener("FrontClick",c),t.addEventListener("BackClick",l),t.addEventListener("LeftClick",x),t.addEventListener("RightClick",g),t.addEventListener("MeshChange",function(){v&&e()})}function o(t){t.removeEventListener("VoxelClick",i),t.removeEventListener("TopClick",s),t.removeEventListener("BottomClick",m),t.removeEventListener("FrontClick",c),t.removeEventListener("BackClick",l),t.removeEventListener("LeftClick",x),t.removeEventListener("RightClick",g)}function i(t){if(h){var e=t.target;a(e)}}function s(t){if(h){var e=t.target;p(e,0,1,0)}}function m(t){if(h){var e=t.target;p(e,0,-1,0)}}function c(t){if(h){var e=t.target;p(e,0,0,1)}}function l(t){if(h){var e=t.target;p(e,0,0,-1)}}function x(t){if(h){var e=t.target;p(e,-1,0,0)}}function g(t){if(h){var e=t.target;p(e,1,0,0)}}function p(t,e,a,n){var o=t.clone(),i=o.getDimension();o.setMesh(k.mesh),o.translate(e*i,a*i,n*i),r(o)}function d(){for(var t,e=0;t=f.getVoxels()[e++];)n(t)}var f,b=this,v=!1,h=!0,k={mesh:{}};b.enable=function(){h=!0},b.disable=function(){h=!1},b.isEnabled=function(){return h},b.enableAutoSave=t,b.disableAutoSave=function(){v=!1},b.canAutoSave=function(){return v},b.save=e,b.load=function(){var t=f.load();return d(),t},b.isSaved=function(){return f.isSaved()},b.deleteSave=function(){return f.deleteSave()},b.export=function(){return f.export()},b.import=function(t){var e=f.import(t);return d(),e},b.add=r,b.remove=a,b.getWorld=function(){return f},b.setToolMesh=function(t){if(void 0===t)return k.mesh;var e=k.mesh;return k.mesh=t,e},function(e,r){if(e===void 0)throw"Editor requires World instance for initialization";f=e,r!==void 0&&!0===r.autosave&&t(),d()}.apply(b,arguments)}},{}],4:[function(t,e){"use strict";function r(){function t(t){if(!t)return o;var r=o;return o=t,e.triggerEvent("change",{target:e}),r}var e=this,o=n;Object.assign(e,{setSource:t,getSource:function getSource(){return o},serialize:function serialize(){return o},clone:function clone(){return new r(o)}}),function(r){a(e),t(r)}.apply(e,arguments)}var a=t("./eventListener"),n="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";e.exports=r,r.loadFromSerial=function(t){return new r(t)}},{"./eventListener":11}],5:[function(t,e){"use strict";var r=t("./eventListener"),a=t("./positioned");e.exports=function(){function t(t){if(void 0===t||"number"!=typeof t)return i;var e=i;return i=t,o.triggerEvent("change",{target:o}),e}function e(t,e){var r=n();return"number"==typeof e&&(s=e),"number"==typeof t&&(m=t),o.triggerEvent("change",{target:o}),r}function n(){return[m,s]}var o=this,i=500,s=1,m=0;Object.assign(o,{setTravelDistance:t,setBrightness:e,getBrightness:n,getTravelDistance:function getTravelDistance(){return i}}),function(n,i,s,m){a(r(o)),o.setPosition(n),t(i),e(s,m)}.apply(o,arguments)}},{"./eventListener":11,"./positioned":14}],6:[function(t,e){"use strict";function r(){function t(t){for(var e in s){var r=s[e];if(r===t)return e}return null}function e(e){return!!t(e.constructor)}function r(t){if(!L(t)){var e=b;return!e||e.removeEventListener("change",d),b=t,b.addEventListener("change",d),E&&f(),e}}function a(t){if(!L(t)){var e=v;return!e||e.removeEventListener("change",d),v=t,v.addEventListener("change",d),E&&f(),e}}function i(t){if(!L(t)){var e=h;return!e||e.removeEventListener("change",d),h=t,h.addEventListener("change",d),E&&f(),e}}function m(t){if(!L(t)){var e=k;return!e||e.removeEventListener("change",d),k=t,k.addEventListener("change",d),E&&f(),e}}function c(t){if(!L(t)){var e=u;return!e||e.removeEventListener("change",d),u=t,u.addEventListener("change",d),E&&f(),e}}function l(t){if(!L(t)){var e=w;return!e||e.removeEventListener("change",d),w=t,w.addEventListener("change",d),E&&f(),e}}function x(t){var n=g();return void 0===t?n:(e(t)&&(t={front:t,back:t,top:t,bottom:t,left:t,right:t}),E=!1,r(t.front),a(t.back),i(t.left),m(t.right),c(t.top),l(t.bottom),f(),E=!0,n)}function g(){return{front:b,back:v,left:h,right:k,top:u,bottom:w}}function p(e){return t(e.constructor)+"("+e.serialize()+")"}function d(){f()}function f(){var t=g();y.triggerEvent("change",{target:y,faces:t})}var b,v,h,k,u,w,y=this,E=!0,L=function(t){return t===void 0||!e(t)};Object.assign(y,{setFront:r,setBack:a,setLeft:i,setRight:m,setTop:c,setBottom:l,setFaces:x,getFaces:g,serialize:function(){return JSON.stringify({front:p(b),back:p(v),left:p(h),right:p(k),top:p(u),bottom:p(w)})},getFront:function getFront(){return b},getBack:function getBack(){return v},getLeft:function getLeft(){return h},getRight:function getRight(){return k},getTop:function getTop(){return u},getBottom:function getBottom(){return w}}),function(t){n(y),x(new o),x(t)}.apply(y,arguments)}function a(t){var e=t.indexOf("("),r=t.slice(0,e),a=t.slice(e+1,-1);return s[r].loadFromSerial(a)}var n=t("./eventListener"),o=t("./ImageFace"),i=t("./ColorFace"),s={image:o,color:i};e.exports=r,r.loadFromSerial=function(t){var e=JSON.parse(t),n=e.front,o=e.back,i=e.left,s=e.right,m=e.top,c=e.bottom;return new r({front:a(n),back:a(o),left:a(i),right:a(s),top:a(m),bottom:a(c)})}},{"./ColorFace":2,"./ImageFace":4,"./eventListener":11}],7:[function(e,r){"use strict";var a=e("./eventListener"),n=16,o=function(t){return t.x||t.clientX},i=function(t){return t.y||t.clientY};r.exports=function(){function e(t){if(void 0===t||"number"!=typeof t)return Q.x;var e=Q.x;return Q.x+=t,Y(),e}function r(t){if(void 0===t||"number"!=typeof t)return Q.y;var e=Q.y;return Q.y+=t,Y(),e}function s(t){if(void 0===t||"number"!=typeof t)return Q.z;var e=Q.z;return Q.z+=t,Y(),e}function m(t){if(void 0===t||"number"!=typeof t)return Q.x;var e=Q.x;return Q.x=t,Y(),e}function c(t){if(void 0===t||"number"!=typeof t)return Q.y;var e=Q.y;return Q.y=t,Y(),e}function l(t){if(void 0===t||"number"!=typeof t)return Q.z;var e=Q.z;return Q.z=t,Y(),e}function g(){return{x:p(),y:d(),z:f()}}function p(){return Q.x}function d(){return Q.y}function f(){return Q.z}function b(t,e,r){return{x:v(t),y:h(e),z:k(r)}}function v(t){if(void 0===t||"number"!=typeof t)return G.x;var e=G.x;return G.x+=t,Y(),e}function h(t){if(void 0===t||"number"!=typeof t)return G.y;var e=G.y;return G.y+=t,Y(),e}function k(t){if(void 0===t||"number"!=typeof t)return G.z;var e=G.z;return G.z+=t,Y(),e}function u(t){if(void 0===t||"number"!=typeof t)return G.x;var e=G.x;return G.x=t,Y(),e}function w(t){if(void 0===t||"number"!=typeof t)return G.y;var e=G.y;return G.y=t,Y(),e}function E(t){if(void 0===t||"number"!=typeof t)return G.z;var e=G.z;return G.z=t,Y(),e}function L(){return{x:G.x,y:G.y,z:G.z}}function A(){return K}function C(){N=document.createElement("div"),N.setAttribute("class","scene"),V=document.createElement("div"),V.setAttribute("class","zoom"),W=document.createElement("div"),W.setAttribute("class","camera"),N.appendChild(V),V.appendChild(W)}function S(){N.addEventListener("mousedown",P),N.addEventListener("mousewheel",B),N.addEventListener("wheel",B)}function P(t){var e=o(t),r=i(t);J.start={x:e,y:r},J.current={x:e,y:r},window.addEventListener("mousemove",M),window.addEventListener("mouseup",F)}function F(){D()}function M(e){var r=o(e),a=i(e),n=r-J.current.x,s=a-J.current.y;if(J.current={x:r,y:a},J.lastMove={dx:n,dy:s},tt&&J.shiftDown)b(n,s),Y(),H.triggerEvent("pan",{rotation:g(),pan:L(),zoom:A(),target:H});else if($){var m=2*t*2;Q.y+=n/window.innerWidth*m,Q.x-=s/window.innerHeight*m,Y(),H.triggerEvent("orbit",{rotation:g(),pan:L(),zoom:A(),target:H})}}function B(t){if(et){return K+=t.deltaY/500,Y(),t.preventDefault(),H.triggerEvent("zoom",{rotation:g(),pan:L(),zoom:A(),target:H}),!1}}function Z(){window.addEventListener("keydown",R),window.addEventListener("keyup",I)}function T(){window.removeEventListener("keydown",R),window.removeEventListener("keyup",I)}function D(){window.removeEventListener("mousemove",M),window.removeEventListener("mouseup",F)}function R(t){J.shiftDown=t.keyCode===n||t.which===n}function I(t){J.shiftDown=t.keyCode!==n&&t.which!==n}function Y(){W.style.transform="rotateX("+Q.x+"rad) rotateY("+Q.y+"rad) rotateZ("+Q.z+"rad)",V.style.transform="scale("+K+", "+K+")",V.style.transform+=" translateX("+G.x+"px) translateY("+G.y+"px) translateZ("+G.z+"px)",X()}function X(){if(0!==rt.length)for(var t,e=0;t=at[e++];)t.updateLightSource(rt)}var O,N,V,W,H=this,q=!1,U=0,_=0,j=0,Q={x:U,y:_,z:j},G={x:U,y:_,z:j},K=1,J={start:{x:U,y:_},current:{x:U,y:_},lastMove:{x:U,y:_},shiftDown:!1},$=!0,tt=!0,et=!0,rt=[],at=[];H.rotate=function(t,a,n){return{x:e(t),y:r(a),z:s(n)}},H.rotateX=e,H.rotateY=r,H.rotateZ=s,H.pan=b,H.panX=v,H.panY=h,H.panZ=k,H.setPan=function(t,e,r){var a={x:u(t),y:w(e),z:E(r)};return Y(),a},H.setPanX=u,H.setPanY=w,H.setPanZ=E,H.getPan=L,H.zoom=function(t){if(void 0===t||"number"!=typeof t)return K;var e=K;return K+=t,Y(),e},H.setZoom=function(t){return void 0===t||"number"!=typeof t?K:(K=t,Y(),K)},H.getZoom=A,H.attach=function(t){if(q)throw"Cannot attach currently attached scene";O=t,t.appendChild(N),q=!0},H.detach=function(){if(!q)throw"Cannot detach currently detached scene";q=!1;var t=N,e=t.parentElement;e&&e.removeChild(N)},H.isAttached=function(){return q},H.getParentElement=function(){return O},H.enableOrbit=function(){$||($=!0)},H.disableOrbit=function(){$&&($=!1)},H.canOrbit=function(){return $},H.enablePan=function(){tt||(tt=!0)},H.disablePan=function(){tt&&(tt=!1)},H.canPan=function(){return tt},H.enableZoom=function(){et||(et=!0)},H.disableZoom=function(){et&&(et=!1)},H.canZoom=function(){return et},H.add=function(t){W.appendChild(t.getDomElement()),at.push(t),t.setParentScene(H),0!==rt.length&&t.updateLightSource(rt)},H.remove=function(t){W.removeChild(t.getDomElement()),at.splice(at.indexOf(t),1),t.removeParentScene()},H.getElement=function(){return N},H.getInteractionState=function(t){return t?J[t]:J},H.unbind=function(){D(),T()},Object.assign(H,{getVoxels:function(){return[].concat(at)},setRotation:function(t,e,r){var a={x:m(t),y:c(e),z:l(r)};return Y(),a},setRotationX:m,setRotationY:c,setRotationZ:l,getRotation:g,getRotationX:p,getRotationY:d,getRotationZ:f,addLightSource:function(t){var e=rt.indexOf(t);return!(-1!==e)&&(t.addEventListener("change",X),t.addEventListener("move",X),rt.push(t),X(),!0)},getLightSources:function(){return rt},removeLightSource:function(t){var e=rt.indexOf(t);return-1!==e&&(t.removeEventListener("change",X),t.removeEventListener("move",X),rt.splice(e,1),X(),!0)}}),function(){a(H),C(),S(),Z()}.apply(H,arguments)}},{"./eventListener":11}],8:[function(e,r){"use strict";function a(){function t(t){if(void 0!==t&&t.constructor===h){var e=M;return!e||e.removeEventListener("change",C),M=t,M.addEventListener("change",C),x(),e}}function e(t){if(void 0===t||"number"!=typeof t)return D;var e=D;return D=t,e}function r(t,e,r,a){var n=f(B.getRotationX(),-B.getRotationY(),B.getRotationZ()),o=w({x:t,y:e,z:r},n);o={x:o.x-Z.getPositionX()-a.A*Z.getDimension()/2,y:o.y-Z.getPositionY()-a.B*Z.getDimension()/2,z:o.z-Z.getPositionZ()-a.C*Z.getDimension()/2};var m=p(g(o.x,2)+g(o.y,2)+g(o.z,2)),c=1===i(a.C)?a.C*o.z:1===i(a.B)?a.B*o.y:a.A*o.x,l=s(i(o.x*a.A+o.y*a.B+o.z*a.C)/m);return{angle:l,direction:c,distance:m}}function w(t,e){var r=[[t.x],[t.y],[t.z]],a=d(e,r);return{x:a[0][0],y:a[1][0],z:a[2][0]}}function x(){var t=M.getFaces();for(var e in T){var r=t[e];if(r instanceof k)T[e].src=r.getSource(),T[e].removeAttribute("class");else if(r instanceof u){var a=T[e].parentElement;a.style.background="#"+r.getHex(),T[e].setAttribute("class","colored")}}}function E(){P=L("div","cube"),F=L("div","anim"),y("top"),y("bottom"),y("front"),y("back"),y("left"),y("right"),P.appendChild(F)}function y(t){var e=function(t){return t+"px"},r=D/2,a=Z,o=L("img",""),i=L("div","shader"),s=L("div","face "+t);T[t]=n(o,{shader:i}),n(s.style,{width:e(D),height:e(D),marginLeft:e(-1*r),marginTop:e(-1*r),transform:{top:"rotateX(90deg) translateZ("+r+"px)",bottom:"rotateX(90deg) translateZ(-"+r+"px)",left:"rotateY(90deg) translateZ(-"+r+"px)",right:"rotateY(90deg) translateZ("+r+"px)",front:"translateZ("+r+"px)",back:"translateZ(-"+r+"px)"}[t]}),s.addEventListener("click",{top:function top(){return Z.triggerEvent("TopClick",{target:a})},bottom:function bottom(){return Z.triggerEvent("BottomClick",{target:a})},left:function left(){return Z.triggerEvent("LeftClick",{target:a})},right:function right(){return Z.triggerEvent("RightClick",{target:a})},front:function front(){return Z.triggerEvent("FrontClick",{target:a})},back:function back(){return Z.triggerEvent("BackClick",{target:a})}}[t]),s.addEventListener("contextmenu",S),s.appendChild(o),s.appendChild(i),F.appendChild(s)}function L(t,e){var r=document.createElement(t);return r.setAttribute("class",e),r}function A(){var t=Z.getPosition();P.style.transform="translate3d("+t.x+"px, "+-t.y+"px, "+t.z+"px)"}function z(){B.add(Z)}function C(){x(),Z.triggerEvent("MeshChange",{target:Z,mesh:M})}function S(t){return t.preventDefault(),Z.triggerEvent("VoxelClick",{target:Z}),!1}var P,F,M,B,Z=this,T={},D=0;n(Z,{setMesh:t,getMesh:function(){return M},animUp:function(t){if(t===void 0)throw"Scene required to add voxel to scene";B=t,F.setAttribute("class","anim up"),z()},animDown:function(t){if(t===void 0)throw"Scene required to add voxel to scene";B=t,F.setAttribute("class","anim down"),z()},addToScene:function(t){if(t===void 0)throw"Scene required to add voxel to scene";B=t,F.setAttribute("class","anim"),z()},removeFromScene:function(){void 0===B||B.remove(Z)},setParentScene:function(t){B=t},removeParentScene:function(){B=void 0},setDimension:e,getDimension:function(){return D},getDomElement:function(){return P},updateLightSource:function(t){var e=function(t){return g(t,3)},a=1,n=1,i=1,s=1,x=1,p=1;t.forEach(function(t){var o=[t.getPositionX(),t.getPositionY(),t.getPositionZ()],d=t.getBrightness(),f=t.getTravelDistance(),b=d[1]-d[0],v=1-d[1],h=function(t){var a=_slicedToArray(t,3),n=a[0],i=a[1],s=a[2],m=r.apply(void 0,o.concat([{A:n,B:i,C:s}])),x=m.angle,p=m.direction,d=m.distance,h=0>p?1:c(1,e(1-x/(l/2))+g(d/f,6));return 1-(h*b+v)};n=m(0,n-h([0,0,-1])),a=m(0,a-h([0,0,1])),i=m(0,i-h([-1,0,0])),s=m(0,s-h([1,0,0])),x=m(0,x-h([0,1,0])),p=m(0,p-h([0,-1,0]))});var d={front:a,back:n,left:i,right:s,top:x,bottom:p};o(d).forEach(function(t){T[t].shader.style.opacity=d[t]})},clone:function(){return new a(Z.getPositionX(),Z.getPositionY(),Z.getPositionZ(),D,{mesh:M})}}),function(r,a,n,o,i){v(b(Z)),Z.addEventListener("move",A),e(o),E(),Z.setPosition([r,a,n]),t(new h),i!==void 0&&i.mesh!==void 0&&t(i.mesh)}.apply(Z,arguments)}var n=Object.assign,o=Object.keys,i=Math.abs,s=Math.asin,m=Math.max,c=Math.min,l=t,g=Math.pow,p=Math.sqrt,x=e("./common"),d=x.multiplyMatrices,f=x.generateRotationMatrix,b=e("./eventListener"),v=e("./positioned"),h=e("./Mesh"),k=e("./ImageFace"),u=e("./ColorFace");r.exports=a},{"./ColorFace":2,"./ImageFace":4,"./Mesh":6,"./common":10,"./eventListener":11,"./positioned":14}],9:[function(t,e){"use strict";var r=t("./Mesh"),a=t("./Voxel");e.exports=function(){function t(t){return x.push(t),m.add(t)}function e(t){var e=x.indexOf(t);return!(0>e)&&(m.remove(t),x.splice(e,1),!0)}function n(){for(var t,e=[],r=0;t=x[r++];)e.push({position:t.getPosition(),dimension:t.getDimension(),mesh:t.getMesh().serialize()});return JSON.stringify(e)}function o(e){s();for(var n,o,m=JSON.parse(e+""),c=0;n=m[c++];)o=new a(n.position.x,n.position.y,n.position.z,n.dimension),o.setMesh(r.loadFromSerial(n.mesh)),t(o)}function s(){for(;0<x.length;)e(x[0])}function i(){return"savedWorld<"+l+">"}var m,c=this,l="*",x=[];c.add=t,c.remove=e,c.export=n,c.import=o,c.save=function(){localStorage.setItem(i(),n())},c.load=function(){o(localStorage.getItem(i())||"[]")},c.isSaved=function(){return!!localStorage.getItem(i())},c.deleteSave=function(){localStorage.setItem(i(),"")},c.getScene=function(){return m},c.getVoxels=function(){return x.concat([])},function(t,e){if(t===void 0)throw"World cannot be instantiated without a Scene instance";m=t,e!==void 0&&(l=e)}.apply(c,arguments)}},{"./Mesh":6,"./Voxel":8}],10:[function(t,e){"use strict";function r(t,e){for(var a=t.length,n=t[0].length,o=e[0].length,s=Array(a),m=0;m<a;++m){s[m]=Array(o);for(var r=0;r<o;++r){s[m][r]=0;for(var c=0;c<n;++c)s[m][r]+=t[m][c]*e[c][r]}}return s}var a=Math.cos,n=Math.sin,o=16;e.exports={hexToRgb:function(t){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(e,function(t,e,r,a){return e+e+r+r+a+a});var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return r?{r:parseInt(r[1],o),g:parseInt(r[2],o),b:parseInt(r[3],o)}:null},rgbToHex:function(t,e,r){return""+(16777216+(t<<16)+(e<<8)+r).toString(16).slice(1)},generateRotationMatrix:function(t,e,o){var i=[[1,0,0],[0,a(t),-n(t)],[0,n(t),a(t)]],s=[[a(e),0,n(e)],[0,1,0],[-n(e),0,a(e)]],m=[[a(o),-n(o),0],[n(o),a(o),0],[0,0,1]];return r(r(m,s),i)},multiplyMatrices:r}},{}],11:[function(t,e){"use strict";e.exports=function(t){var e=t||new Function,r={};return Object.assign(e,{addEventListener:function(t,e){(t="on"+t,"function"==typeof e)&&(r[t]||(r[t]=[]),-1<r[t].indexOf(e)||r[t].push(e))},removeEventListener:function(t,e){t="on"+t,r[t]&&r[t].splice(r[t].indexOf(e),1)},triggerEvent:function(t,e){t="on"+t;var a=r[t];if(a)for(var n,o=0;n=a[o++];)n(e)}}),e}},{}],12:[function(t,e){"use strict";t("../dist/voxelcss.css");var r=t("./ColorFace"),a=t("./Editor"),n=t("./eventListener"),o=t("./ImageFace"),i=t("./LightSource"),s=t("./Mesh"),m=t("./meshes"),c=t("./positioned"),l=t("./Scene"),x=t("./Voxel"),g=t("./World");e.exports={ColorFace:r,Editor:a,eventListener:n,ImageFace:o,LightSource:i,Mesh:s,meshes:m,Positioned:c,Scene:l,Voxel:x,World:g}},{"../dist/voxelcss.css":1,"./ColorFace":2,"./Editor":3,"./ImageFace":4,"./LightSource":5,"./Mesh":6,"./Scene":7,"./Voxel":8,"./World":9,"./eventListener":11,"./meshes":13,"./positioned":14}],13:[function(t,e){"use strict";var r=t("./Mesh"),a=t("./ImageFace");e.exports={dirt:new r(new a("http://voxelcss.com/res/dirt/main.png")),grass:new r({top:new a("http://voxelcss.com/res/grass/top.png"),bottom:new a("http://voxelcss.com/res/grass/bottom.png"),front:new a("http://voxelcss.com/res/grass/side.png"),back:new a("http://voxelcss.com/res/grass/side.png"),left:new a("http://voxelcss.com/res/grass/side.png"),right:new a("http://voxelcss.com/res/grass/side.png")}),water:new r(new a("http://voxelcss.com/res/water/main.png")),waterFall:new r({top:new a("http://voxelcss.com/res/water/main.png"),bottom:new a("http://voxelcss.com/res/water/main.png"),front:new a("http://voxelcss.com/res/water/fall.png"),back:new a("http://voxelcss.com/res/water/fall.png"),left:new a("http://voxelcss.com/res/water/fall.png"),right:new a("http://voxelcss.com/res/water/fall.png")}),waterFallTop:new r({top:new a("http://voxelcss.com/res/water/main.png"),bottom:new a("http://voxelcss.com/res/water/main.png"),front:new a("http://voxelcss.com/res/water/falltop.png"),back:new a("http://voxelcss.com/res/water/falltop.png"),left:new a("http://voxelcss.com/res/water/falltop.png"),right:new a("http://voxelcss.com/res/water/falltop.png")}),waterFallCrash:new r({top:new a("http://voxelcss.com/res/water/main.png"),bottom:new a("http://voxelcss.com/res/water/main.png"),front:new a("http://voxelcss.com/res/water/crash.png"),back:new a("http://voxelcss.com/res/water/crash.png"),left:new a("http://voxelcss.com/res/water/crash.png"),right:new a("http://voxelcss.com/res/water/crash.png")}),treeTrunk:new r({top:new a("http://voxelcss.com/res/tree/rings.png"),bottom:new a("http://voxelcss.com/res/tree/rings.png"),front:new a("http://voxelcss.com/res/tree/bark.png"),back:new a("http://voxelcss.com/res/tree/bark.png"),left:new a("http://voxelcss.com/res/tree/bark.png"),right:new a("http://voxelcss.com/res/tree/bark.png")}),treeLeaves:new r(new a("http://voxelcss.com/res/tree/leaves.png"))}},{"./ImageFace":4,"./Mesh":6}],14:[function(t,e){"use strict";e.exports=function(t){function e(t){if(void 0===t||"number"!=typeof t)return m.x;var e=m.x;return m.x=t,c&&s.triggerEvent("move"),e}function r(t){if(void 0===t||"number"!=typeof t)return m.y;var e=m.y;return m.y=t,c&&s.triggerEvent("move"),e}function a(t){if(void 0===t||"number"!=typeof t)return m.z;var e=m.z;return m.z=t,c&&s.triggerEvent("move"),e}function n(t){return void 0===t||"number"!=typeof t?m.x:e(t+m.x)}function o(t){return void 0===t||"number"!=typeof t?m.y:r(t+m.y)}function i(t){return void 0===t||"number"!=typeof t?m.z:a(t+m.z)}var s=t||new Function,m={x:0,y:0,z:0},c=!0;return Object.assign(s,{setPosition:function(t){var n=_slicedToArray(t,3),o=n[0],i=n[1],m=n[2];c=!1;var l={x:e(o),y:r(i),z:a(m)};return c=!0,s.triggerEvent("move"),l},setPositionX:e,setPositionY:r,setPositionZ:a,getPosition:function(){return{x:m.x,y:m.y,z:m.z}},getPositionX:function(){return m.x},getPositionY:function(){return m.y},getPositionZ:function(){return m.z},translate:function(t,e,r){c=!1;var a={x:n(t),y:o(e),z:i(r)};return c=!0,s.triggerEvent("move"),a},translateX:n,translateY:o,translateZ:i}),s}},{}],15:[function(t,e){"use strict";var r=[],a=function(t,e){var a=document.head||document.getElementsByTagName("head")[0],n=r[r.length-1];if(e=e||{},e.insertAt=e.insertAt||"bottom","top"===e.insertAt)n?n.nextSibling?a.insertBefore(t,n.nextSibling):a.appendChild(t):a.insertBefore(t,a.firstChild),r.push(t);else if("bottom"===e.insertAt)a.appendChild(t);else throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.")};e.exports={createLink:function createLink(t,e){var r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("link");for(var n in a.href=t,a.rel="stylesheet",e)if(e.hasOwnProperty(n)){var o=e[n];a.setAttribute("data-"+n,o)}r.appendChild(a)},createStyle:function createStyle(t,e,r){r=r||{};var n=document.createElement("style");for(var o in n.type="text/css",e)if(e.hasOwnProperty(o)){var i=e[o];n.setAttribute("data-"+o,i)}n.sheet?(n.innerHTML=t,n.sheet.cssText=t,a(n,{insertAt:r.insertAt})):n.styleSheet?(a(n,{insertAt:r.insertAt}),n.styleSheet.cssText=t):(n.appendChild(document.createTextNode(t)),a(n,{insertAt:r.insertAt}))}}},{}]},{},[12])(12)});
