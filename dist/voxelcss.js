"use strict";var _slicedToArray=function(){function t(t,e){var r=[],a=!0,n=!1,o=void 0;try{for(var i,s=t[Symbol.iterator]();!(a=(i=s.next()).done)&&(r.push(i.value),!(e&&r.length===e));a=!0);}catch(t){n=!0,o=t}finally{try{!a&&s["return"]&&s["return"]()}finally{if(n)throw o}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};(function(t){if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window,e.voxelcss=t()}})(function(){var t=Math.PI;return function m(c,t,e){function r(i,o){if(!t[i]){if(!c[i]){var s="function"==typeof require&&require;if(!o&&s)return s(i,!0);if(n)return n(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var x=t[i]={exports:{}};c[i][0].call(x.exports,function(t){var e=c[i][1][t];return r(e?e:t)},x,x.exports,m,c,t,e)}return t[i].exports}for(var n="function"==typeof require&&require,a=0;a<e.length;a++)r(e[a]);return r}({1:[function(t,e){var r=".scene {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-perspective: 1000px;\n  perspective: 1000px;\n  -webkit-perspective-origin: 50% 50%;\n  perspective-origin: 50% 50%;\n  cursor: move;\n}\n.scene .camera,\n.scene .zoom {\n  top: 50%;\n  left: 50%;\n  width: 0;\n  height: 0;\n  overflow: visible;\n}\n.cube,\n.scene .camera,\n.scene .zoom {\n  position: absolute;\n  -webkit-transform-style: preserve-3d;\n  transform-style: preserve-3d;\n}\n.cube:hover img {\n  visibility: hidden!important;\n}\n.cube:hover .face {\n  background: rgba(0,0,0,.3)!important;\n}\n.cube:hover .face .shader {\n  opacity: 0!important;\n}\n.cube .anim {\n  -webkit-transform-style: preserve-3d;\n  transform-style: preserve-3d;\n}\n.cube .anim.down {\n  -webkit-animation: b 1s linear both;\n  animation: b 1s linear both;\n}\n.cube .anim.up {\n  -webkit-animation: a 1s linear both;\n  animation: a 1s linear both;\n}\n.face {\n  display: block;\n  position: absolute;\n  outline: none;\n  border: none;\n  margin-left: -18px;\n  margin-top: -18px;\n  width: 36px;\n  height: 36px;\n  cursor: pointer;\n}\n.face img {\n  width: 100%;\n  height: 100%;\n}\n.face img.colored {\n  visibility: hidden;\n}\n.face .shader {\n  display: block;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: #000;\n  opacity: 0;\n}\n@-webkit-keyframes a {\n  0% {\n    opacity: 0;\n    -webkit-transform: matrix(1,0,0,1,0,300);\n    transform: matrix(1,0,0,1,0,300);\n  }\n\n  1.3% {\n    -webkit-transform: matrix(1,0,0,3.905,0,237.02);\n    transform: matrix(1,0,0,3.905,0,237.02);\n  }\n\n  2.55% {\n    -webkit-transform: matrix(1,0,0,4.554,0,182.798);\n    transform: matrix(1,0,0,4.554,0,182.798);\n  }\n\n  4.1% {\n    -webkit-transform: matrix(1,0,0,4.025,0,125.912);\n    transform: matrix(1,0,0,4.025,0,125.912);\n  }\n\n  5.71% {\n    -webkit-transform: matrix(1,0,0,3.039,0,79.596);\n    transform: matrix(1,0,0,3.039,0,79.596);\n  }\n\n  8.11% {\n    opacity: 1;\n    -webkit-transform: matrix(1,0,0,1.82,0,31.647);\n    transform: matrix(1,0,0,1.82,0,31.647);\n  }\n\n  8.81% {\n    -webkit-transform: matrix(1,0,0,1.581,0,21.84);\n    transform: matrix(1,0,0,1.581,0,21.84);\n  }\n\n  11.96% {\n    -webkit-transform: matrix(1,0,0,1.034,0,-4.825);\n    transform: matrix(1,0,0,1.034,0,-4.825);\n  }\n\n  12.11% {\n    -webkit-transform: matrix(1,0,0,1.023,0,-5.53);\n    transform: matrix(1,0,0,1.023,0,-5.53);\n  }\n\n  15.07% {\n    -webkit-transform: matrix(1,0,0,.947,0,-12.662);\n    transform: matrix(1,0,0,.947,0,-12.662);\n  }\n\n  16.12% {\n    -webkit-transform: matrix(1,0,0,.951,0,-13.007);\n    transform: matrix(1,0,0,.951,0,-13.007);\n  }\n\n  27.23% {\n    -webkit-transform: matrix(1,0,0,1.001,0,-2.352);\n    transform: matrix(1,0,0,1.001,0,-2.352);\n  }\n\n  27.58% {\n    -webkit-transform: matrix(1,0,0,1.001,0,-2.121);\n    transform: matrix(1,0,0,1.001,0,-2.121);\n  }\n\n  38.34% {\n    -webkit-transform: matrix(1,0,0,1,0,.311);\n    transform: matrix(1,0,0,1,0,.311);\n  }\n\n  40.09% {\n    -webkit-transform: matrix(1,0,0,1,0,.291);\n    transform: matrix(1,0,0,1,0,.291);\n  }\n\n  50% {\n    -webkit-transform: matrix(1,0,0,1,0,.048);\n    transform: matrix(1,0,0,1,0,.048);\n  }\n\n  60.56% {\n    -webkit-transform: matrix(1,0,0,1,0,-.007);\n    transform: matrix(1,0,0,1,0,-.007);\n  }\n\n  82.78% {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n\n  to {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n}\n@keyframes a {\n  0% {\n    opacity: 0;\n    -webkit-transform: matrix(1,0,0,1,0,300);\n    transform: matrix(1,0,0,1,0,300);\n  }\n\n  1.3% {\n    -webkit-transform: matrix(1,0,0,3.905,0,237.02);\n    transform: matrix(1,0,0,3.905,0,237.02);\n  }\n\n  2.55% {\n    -webkit-transform: matrix(1,0,0,4.554,0,182.798);\n    transform: matrix(1,0,0,4.554,0,182.798);\n  }\n\n  4.1% {\n    -webkit-transform: matrix(1,0,0,4.025,0,125.912);\n    transform: matrix(1,0,0,4.025,0,125.912);\n  }\n\n  5.71% {\n    -webkit-transform: matrix(1,0,0,3.039,0,79.596);\n    transform: matrix(1,0,0,3.039,0,79.596);\n  }\n\n  8.11% {\n    opacity: 1;\n    -webkit-transform: matrix(1,0,0,1.82,0,31.647);\n    transform: matrix(1,0,0,1.82,0,31.647);\n  }\n\n  8.81% {\n    -webkit-transform: matrix(1,0,0,1.581,0,21.84);\n    transform: matrix(1,0,0,1.581,0,21.84);\n  }\n\n  11.96% {\n    -webkit-transform: matrix(1,0,0,1.034,0,-4.825);\n    transform: matrix(1,0,0,1.034,0,-4.825);\n  }\n\n  12.11% {\n    -webkit-transform: matrix(1,0,0,1.023,0,-5.53);\n    transform: matrix(1,0,0,1.023,0,-5.53);\n  }\n\n  15.07% {\n    -webkit-transform: matrix(1,0,0,.947,0,-12.662);\n    transform: matrix(1,0,0,.947,0,-12.662);\n  }\n\n  16.12% {\n    -webkit-transform: matrix(1,0,0,.951,0,-13.007);\n    transform: matrix(1,0,0,.951,0,-13.007);\n  }\n\n  27.23% {\n    -webkit-transform: matrix(1,0,0,1.001,0,-2.352);\n    transform: matrix(1,0,0,1.001,0,-2.352);\n  }\n\n  27.58% {\n    -webkit-transform: matrix(1,0,0,1.001,0,-2.121);\n    transform: matrix(1,0,0,1.001,0,-2.121);\n  }\n\n  38.34% {\n    -webkit-transform: matrix(1,0,0,1,0,.311);\n    transform: matrix(1,0,0,1,0,.311);\n  }\n\n  40.09% {\n    -webkit-transform: matrix(1,0,0,1,0,.291);\n    transform: matrix(1,0,0,1,0,.291);\n  }\n\n  50% {\n    -webkit-transform: matrix(1,0,0,1,0,.048);\n    transform: matrix(1,0,0,1,0,.048);\n  }\n\n  60.56% {\n    -webkit-transform: matrix(1,0,0,1,0,-.007);\n    transform: matrix(1,0,0,1,0,-.007);\n  }\n\n  82.78% {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n\n  to {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n}\n@-webkit-keyframes b {\n  0% {\n    opacity: 0;\n    -webkit-transform: matrix(1,0,0,1,0,-300);\n    transform: matrix(1,0,0,1,0,-300);\n  }\n\n  1.3% {\n    -webkit-transform: matrix(1,0,0,3.905,0,-237.02);\n    transform: matrix(1,0,0,3.905,0,-237.02);\n  }\n\n  2.55% {\n    -webkit-transform: matrix(1,0,0,4.554,0,-182.798);\n    transform: matrix(1,0,0,4.554,0,-182.798);\n  }\n\n  4.1% {\n    -webkit-transform: matrix(1,0,0,4.025,0,-125.912);\n    transform: matrix(1,0,0,4.025,0,-125.912);\n  }\n\n  5.71% {\n    -webkit-transform: matrix(1,0,0,3.039,0,-79.596);\n    transform: matrix(1,0,0,3.039,0,-79.596);\n  }\n\n  8.11% {\n    opacity: 1;\n    -webkit-transform: matrix(1,0,0,1.82,0,-31.647);\n    transform: matrix(1,0,0,1.82,0,-31.647);\n  }\n\n  8.81% {\n    -webkit-transform: matrix(1,0,0,1.581,0,-21.84);\n    transform: matrix(1,0,0,1.581,0,-21.84);\n  }\n\n  11.96% {\n    -webkit-transform: matrix(1,0,0,1.034,0,4.825);\n    transform: matrix(1,0,0,1.034,0,4.825);\n  }\n\n  12.11% {\n    -webkit-transform: matrix(1,0,0,1.023,0,5.53);\n    transform: matrix(1,0,0,1.023,0,5.53);\n  }\n\n  15.07% {\n    -webkit-transform: matrix(1,0,0,.947,0,12.662);\n    transform: matrix(1,0,0,.947,0,12.662);\n  }\n\n  16.12% {\n    -webkit-transform: matrix(1,0,0,.951,0,13.007);\n    transform: matrix(1,0,0,.951,0,13.007);\n  }\n\n  27.23% {\n    -webkit-transform: matrix(1,0,0,1.001,0,2.352);\n    transform: matrix(1,0,0,1.001,0,2.352);\n  }\n\n  27.58% {\n    -webkit-transform: matrix(1,0,0,1.001,0,2.121);\n    transform: matrix(1,0,0,1.001,0,2.121);\n  }\n\n  38.34% {\n    -webkit-transform: matrix(1,0,0,1,0,-.311);\n    transform: matrix(1,0,0,1,0,-.311);\n  }\n\n  40.09% {\n    -webkit-transform: matrix(1,0,0,1,0,-.291);\n    transform: matrix(1,0,0,1,0,-.291);\n  }\n\n  50% {\n    -webkit-transform: matrix(1,0,0,1,0,-.048);\n    transform: matrix(1,0,0,1,0,-.048);\n  }\n\n  60.56% {\n    -webkit-transform: matrix(1,0,0,1,0,.007);\n    transform: matrix(1,0,0,1,0,.007);\n  }\n\n  82.78% {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n\n  to {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n}\n@keyframes b {\n  0% {\n    opacity: 0;\n    -webkit-transform: matrix(1,0,0,1,0,-300);\n    transform: matrix(1,0,0,1,0,-300);\n  }\n\n  1.3% {\n    -webkit-transform: matrix(1,0,0,3.905,0,-237.02);\n    transform: matrix(1,0,0,3.905,0,-237.02);\n  }\n\n  2.55% {\n    -webkit-transform: matrix(1,0,0,4.554,0,-182.798);\n    transform: matrix(1,0,0,4.554,0,-182.798);\n  }\n\n  4.1% {\n    -webkit-transform: matrix(1,0,0,4.025,0,-125.912);\n    transform: matrix(1,0,0,4.025,0,-125.912);\n  }\n\n  5.71% {\n    -webkit-transform: matrix(1,0,0,3.039,0,-79.596);\n    transform: matrix(1,0,0,3.039,0,-79.596);\n  }\n\n  8.11% {\n    opacity: 1;\n    -webkit-transform: matrix(1,0,0,1.82,0,-31.647);\n    transform: matrix(1,0,0,1.82,0,-31.647);\n  }\n\n  8.81% {\n    -webkit-transform: matrix(1,0,0,1.581,0,-21.84);\n    transform: matrix(1,0,0,1.581,0,-21.84);\n  }\n\n  11.96% {\n    -webkit-transform: matrix(1,0,0,1.034,0,4.825);\n    transform: matrix(1,0,0,1.034,0,4.825);\n  }\n\n  12.11% {\n    -webkit-transform: matrix(1,0,0,1.023,0,5.53);\n    transform: matrix(1,0,0,1.023,0,5.53);\n  }\n\n  15.07% {\n    -webkit-transform: matrix(1,0,0,.947,0,12.662);\n    transform: matrix(1,0,0,.947,0,12.662);\n  }\n\n  16.12% {\n    -webkit-transform: matrix(1,0,0,.951,0,13.007);\n    transform: matrix(1,0,0,.951,0,13.007);\n  }\n\n  27.23% {\n    -webkit-transform: matrix(1,0,0,1.001,0,2.352);\n    transform: matrix(1,0,0,1.001,0,2.352);\n  }\n\n  27.58% {\n    -webkit-transform: matrix(1,0,0,1.001,0,2.121);\n    transform: matrix(1,0,0,1.001,0,2.121);\n  }\n\n  38.34% {\n    -webkit-transform: matrix(1,0,0,1,0,-.311);\n    transform: matrix(1,0,0,1,0,-.311);\n  }\n\n  40.09% {\n    -webkit-transform: matrix(1,0,0,1,0,-.291);\n    transform: matrix(1,0,0,1,0,-.291);\n  }\n\n  50% {\n    -webkit-transform: matrix(1,0,0,1,0,-.048);\n    transform: matrix(1,0,0,1,0,-.048);\n  }\n\n  60.56% {\n    -webkit-transform: matrix(1,0,0,1,0,.007);\n    transform: matrix(1,0,0,1,0,.007);\n  }\n\n  82.78% {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n\n  to {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n}\n";t("browserify-css").createStyle(r,{href:"dist/voxelcss.css"},{insertAt:"bottom"}),e.exports=r},{"browserify-css":15}],2:[function(t,e){"use strict";function r(){function t(){return 1===arguments.length&&arguments[0].constructor!==Number?arguments[0].constructor===String?m(arguments[0]):s(arguments[0]):a.apply(this,arguments)}function e(){return x}function a(t,r,n,o){var a=e();return void 0!==t&&t.constructor===Number&&(x.r=t),void 0!==r&&r.constructor===Number&&(x.g=r),void 0!==n&&n.constructor===Number&&(x.b=n),void 0!==o&&o.constructor===Number&&(x.a=o),c(),a}function s(t){return a(t.r,t.g,t.b,t.a)}function m(t){return x=n(t),x.a=1,c(),e()}function c(){l.triggerEvent("change",{target:l})}var l=this,x={r:0,g:0,b:0,a:1};Object.assign(l,{setColor:t,getColor:e,getHex:function getHex(){return o(x.r,x.g,x.b)},serialize:function serialize(){return JSON.stringify(x)},clone:function clone(){return new r(x)}}),function(){i(l),t.apply(this,arguments)}.apply(l,arguments)}var a=t("./common"),n=a.hexToRgb,o=a.rgbToHex,i=t("./eventListener");e.exports=r,r.loadFromSerial=function(t){var e=JSON.parse(t);return new r(e)}},{"./common":10,"./eventListener":11}],3:[function(t,e){"use strict";e.exports=function(){function t(){b=!0}function e(){f.save()}function r(t){n(t);var r=f.add(t);return b&&e(),r}function a(t){var r=f.remove(t);return r&&o(t),b&&e(),r}function n(t){t.addEventListener("VoxelClick",i),t.addEventListener("TopClick",s),t.addEventListener("BottomClick",m),t.addEventListener("FrontClick",c),t.addEventListener("BackClick",l),t.addEventListener("LeftClick",x),t.addEventListener("RightClick",g),t.addEventListener("MeshChange",function(){b&&e()})}function o(t){t.removeEventListener("VoxelClick",i),t.removeEventListener("TopClick",s),t.removeEventListener("BottomClick",m),t.removeEventListener("FrontClick",c),t.removeEventListener("BackClick",l),t.removeEventListener("LeftClick",x),t.removeEventListener("RightClick",g)}function i(t){if(h){var e=t.target;a(e)}}function s(t){if(h){var e=t.target;p(e,0,1,0)}}function m(t){if(h){var e=t.target;p(e,0,-1,0)}}function c(t){if(h){var e=t.target;p(e,0,0,1)}}function l(t){if(h){var e=t.target;p(e,0,0,-1)}}function x(t){if(h){var e=t.target;p(e,-1,0,0)}}function g(t){if(h){var e=t.target;p(e,1,0,0)}}function p(t,e,a,n){var o=t.clone(),i=o.getDimension();o.setMesh(k.mesh),o.translate(e*i,a*i,n*i),r(o)}function d(){for(var t,e=0;t=f.getVoxels()[e++];)n(t)}var f,v=this,b=!1,h=!0,k={mesh:{}};v.enable=function(){h=!0},v.disable=function(){h=!1},v.isEnabled=function(){return h},v.enableAutoSave=t,v.disableAutoSave=function(){b=!1},v.canAutoSave=function(){return b},v.save=e,v.load=function(){var t=f.load();return d(),t},v.isSaved=function(){return f.isSaved()},v.deleteSave=function(){return f.deleteSave()},v.export=function(){return f.export()},v.import=function(t){var e=f.import(t);return d(),e},v.add=r,v.remove=a,v.getWorld=function(){return f},v.setToolMesh=function(t){if(void 0===t)return k.mesh;var e=k.mesh;return k.mesh=t,e},function(e,r){if(e===void 0)throw"Editor requires World instance for initialization";f=e,r!==void 0&&!0===r.autosave&&t(),d()}.apply(v,arguments)}},{}],4:[function(t,e){"use strict";function r(){function t(t){if(!t)return o;var r=o;return o=t,e.triggerEvent("change",{target:e}),r}var e=this,o=n;Object.assign(e,{setSource:t,getSource:function getSource(){return o},serialize:function serialize(){return o},clone:function clone(){return new r(o)}}),function(r){a(e),t(r)}.apply(e,arguments)}var a=t("./eventListener"),n="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";e.exports=r,r.loadFromSerial=function(t){return new r(t)}},{"./eventListener":11}],5:[function(t,e){"use strict";var r=t("./eventListener"),a=t("./positioned");e.exports=function(){function t(t){if(void 0===t||"number"!=typeof t)return i;var e=i;return i=t,o.triggerEvent("change",{target:o}),e}function e(t,e){var r=n();return"number"==typeof e&&(s=e),"number"==typeof t&&(m=t),o.triggerEvent("change",{target:o}),r}function n(){return[m,s]}var o=this,i=500,s=1,m=0;Object.assign(o,{setTravelDistance:t,getTravelDistance:function(){return i},setBrightness:e,getBrightness:n}),function(n,i,s,m,c,l){a(r(o)),o.setPosition(n,i,s),t(m),e(c,l)}.apply(o,arguments)}},{"./eventListener":11,"./positioned":14}],6:[function(t,e){"use strict";function r(){function t(t){for(var e in s){var r=s[e];if(r===t)return e}return null}function e(e){return!!t(e.constructor)}function r(t){if(!L(t)){var e=v;return!e||e.removeEventListener("change",d),v=t,v.addEventListener("change",d),E&&f(),e}}function a(t){if(!L(t)){var e=b;return!e||e.removeEventListener("change",d),b=t,b.addEventListener("change",d),E&&f(),e}}function i(t){if(!L(t)){var e=h;return!e||e.removeEventListener("change",d),h=t,h.addEventListener("change",d),E&&f(),e}}function m(t){if(!L(t)){var e=k;return!e||e.removeEventListener("change",d),k=t,k.addEventListener("change",d),E&&f(),e}}function c(t){if(!L(t)){var e=u;return!e||e.removeEventListener("change",d),u=t,u.addEventListener("change",d),E&&f(),e}}function l(t){if(!L(t)){var e=y;return!e||e.removeEventListener("change",d),y=t,y.addEventListener("change",d),E&&f(),e}}function x(t){var n=g();return void 0===t?n:(e(t)&&(t={front:t,back:t,top:t,bottom:t,left:t,right:t}),E=!1,r(t.front),a(t.back),i(t.left),m(t.right),c(t.top),l(t.bottom),f(),E=!0,n)}function g(){return{front:v,back:b,left:h,right:k,top:u,bottom:y}}function p(e){return t(e.constructor)+"("+e.serialize()+")"}function d(){f()}function f(){var t=g();w.triggerEvent("change",{target:w,faces:t})}var v,b,h,k,u,y,w=this,E=!0,L=function(t){return t===void 0||!e(t)};Object.assign(w,{setFront:r,setBack:a,setLeft:i,setRight:m,setTop:c,setBottom:l,setFaces:x,getFaces:g,serialize:function(){return JSON.stringify({front:p(v),back:p(b),left:p(h),right:p(k),top:p(u),bottom:p(y)})},getFront:function getFront(){return v},getBack:function getBack(){return b},getLeft:function getLeft(){return h},getRight:function getRight(){return k},getTop:function getTop(){return u},getBottom:function getBottom(){return y}}),function(t){n(w),x(new o),x(t)}.apply(w,arguments)}function a(t){var e=t.indexOf("("),r=t.slice(0,e),a=t.slice(e+1,-1);return s[r].loadFromSerial(a)}var n=t("./eventListener"),o=t("./ImageFace"),i=t("./ColorFace"),s={image:o,color:i};e.exports=r,r.loadFromSerial=function(t){var e=JSON.parse(t),n=e.front,o=e.back,i=e.left,s=e.right,m=e.top,c=e.bottom;return new r({front:a(n),back:a(o),left:a(i),right:a(s),top:a(m),bottom:a(c)})}},{"./ColorFace":2,"./ImageFace":4,"./eventListener":11}],7:[function(e,r){"use strict";var a=e("./eventListener"),n=16;r.exports=function(){function e(t){if(void 0===t||"number"!=typeof t)return _.x;var e=_.x;return _.x+=t,R(),e}function r(t){if(void 0===t||"number"!=typeof t)return _.y;var e=_.y;return _.y+=t,R(),e}function o(t){if(void 0===t||"number"!=typeof t)return _.z;var e=_.z;return _.z+=t,R(),e}function i(t){if(void 0===t||"number"!=typeof t)return _.x;var e=_.x;return _.x=t,R(),e}function s(t){if(void 0===t||"number"!=typeof t)return _.y;var e=_.y;return _.y=t,R(),e}function m(t){if(void 0===t||"number"!=typeof t)return _.z;var e=_.z;return _.z=t,R(),e}function c(){return{x:l(),y:g(),z:p()}}function l(){return _.x}function g(){return _.y}function p(){return _.z}function d(t,e,r){return{x:f(t),y:v(e),z:b(r)}}function f(t){if(void 0===t||"number"!=typeof t)return j.x;var e=j.x;return j.x+=t,R(),e}function v(t){if(void 0===t||"number"!=typeof t)return j.y;var e=j.y;return j.y+=t,R(),e}function b(t){if(void 0===t||"number"!=typeof t)return j.z;var e=j.z;return j.z+=t,R(),e}function h(t){if(void 0===t||"number"!=typeof t)return j.x;var e=j.x;return j.x=t,R(),e}function k(t){if(void 0===t||"number"!=typeof t)return j.y;var e=j.y;return j.y=t,R(),e}function u(t){if(void 0===t||"number"!=typeof t)return j.z;var e=j.z;return j.z=t,R(),e}function w(){return{x:j.x,y:j.y,z:j.z}}function E(){return Q}function L(){I=document.createElement("div"),I.setAttribute("class","scene"),O=document.createElement("div"),O.setAttribute("class","zoom"),N=document.createElement("div"),N.setAttribute("class","camera"),I.appendChild(O),O.appendChild(N)}function A(){I.addEventListener("mousedown",C),I.addEventListener("mousewheel",F),I.addEventListener("wheel",F)}function C(t){G.start.x=t.x||t.clientX,G.start.y=t.y||t.clientY,G.current.x=t.x||t.clientX,G.current.y=t.y||t.clientY,window.addEventListener("mousemove",P),window.addEventListener("mouseup",S)}function S(){Z()}function P(e){if(G.lastMove.dx=(e.x||e.clientX)-G.current.x,G.lastMove.dy=(e.y||e.clientY)-G.current.y,G.current.x=e.x||e.clientX,G.current.y=e.y||e.clientY,J&&G.shiftDown)d(G.lastMove.dx,G.lastMove.dy),R(),V.triggerEvent("pan",{rotation:c(),pan:w(),zoom:E(),target:V});else if(K){var r=2*t*2;_.y+=G.lastMove.dx/window.innerWidth*r,_.x-=G.lastMove.dy/window.innerHeight*r,R(),V.triggerEvent("orbit",{rotation:c(),pan:w(),zoom:E(),target:V})}}function F(t){if($){return Q+=t.deltaY/500,R(),t.preventDefault(),V.triggerEvent("zoom",{rotation:c(),pan:w(),zoom:E(),target:V}),!1}}function M(){window.addEventListener("keydown",T),window.addEventListener("keyup",D)}function B(){window.removeEventListener("keydown",T),window.removeEventListener("keyup",D)}function Z(){window.removeEventListener("mousemove",P),window.removeEventListener("mouseup",S)}function T(t){G.shiftDown=t.keyCode===n||t.which===n}function D(t){G.shiftDown=t.keyCode!==n&&t.which!==n}function R(){N.style.transform="rotateX("+_.x+"rad) rotateY("+_.y+"rad) rotateZ("+_.z+"rad)",O.style.transform="scale("+Q+", "+Q+")",O.style.transform+=" translateX("+j.x+"px) translateY("+j.y+"px) translateZ("+j.z+"px)",Y()}function Y(){if(0!==tt.length)for(var t,e=0;t=et[e++];)t.updateLightSource(tt)}var X,I,O,N,V=this,W=!1,H=0,q=0,U=0,_={x:H,y:q,z:U},j={x:H,y:q,z:U},Q=1,G={start:{x:H,y:q},current:{x:H,y:q},lastMove:{x:H,y:q},shiftDown:!1},K=!0,J=!0,$=!0,tt=[],et=[];V.rotate=function(t,a,n){return{x:e(t),y:r(a),z:o(n)}},V.rotateX=e,V.rotateY=r,V.rotateZ=o,V.pan=d,V.panX=f,V.panY=v,V.panZ=b,V.setPan=function(t,e,r){var a={x:h(t),y:k(e),z:u(r)};return R(),a},V.setPanX=h,V.setPanY=k,V.setPanZ=u,V.getPan=w,V.zoom=function(t){if(void 0===t||"number"!=typeof t)return Q;var e=Q;return Q+=t,R(),e},V.setZoom=function(t){return void 0===t||"number"!=typeof t?Q:(Q=t,R(),Q)},V.getZoom=E,V.attach=function(t){if(W)throw"Cannot attach currently attached scene";X=t,t.appendChild(I),W=!0},V.detach=function(){if(!W)throw"Cannot detach currently detached scene";W=!1;var t=I,e=t.parentElement;e&&e.removeChild(I)},V.isAttached=function(){return W},V.getParentElement=function(){return X},V.enableOrbit=function(){K||(K=!0)},V.disableOrbit=function(){K&&(K=!1)},V.canOrbit=function(){return K},V.enablePan=function(){J||(J=!0)},V.disablePan=function(){J&&(J=!1)},V.canPan=function(){return J},V.enableZoom=function(){$||($=!0)},V.disableZoom=function(){$&&($=!1)},V.canZoom=function(){return $},V.add=function(t){N.appendChild(t.getDomElement()),et.push(t),t.setParentScene(V),0!==tt.length&&t.updateLightSource(tt)},V.remove=function(t){N.removeChild(t.getDomElement()),et.splice(et.indexOf(t),1),t.removeParentScene()},V.getElement=function(){return I},V.getInteractionState=function(t){return t?G[t]:G},V.unbind=function(){Z(),B()},Object.assign(V,{getVoxels:function(){return[].concat(et)},setRotation:function(t,e,r){var a={x:i(t),y:s(e),z:m(r)};return R(),a},setRotationX:i,setRotationY:s,setRotationZ:m,getRotation:c,getRotationX:l,getRotationY:g,getRotationZ:p,addLightSource:function(t){var e=tt.indexOf(t);return!(-1!==e)&&(t.addEventListener("change",Y),t.addEventListener("move",Y),tt.push(t),Y(),!0)},getLightSources:function(){return tt},removeLightSource:function(t){var e=tt.indexOf(t);return-1!==e&&(t.removeEventListener("change",Y),t.removeEventListener("move",Y),tt.splice(e,1),Y(),!0)}}),function(){a(V),L(),A(),M()}.apply(V,arguments)}},{"./eventListener":11}],8:[function(e,r){"use strict";function a(){function t(t){if(void 0!==t&&t.constructor===h){var e=M;return!e||e.removeEventListener("change",C),M=t,M.addEventListener("change",C),x(),e}}function e(t){if(void 0===t||"number"!=typeof t)return D;var e=D;return D=t,e}function r(t,e,r,a){var n=f(B.getRotationX(),-B.getRotationY(),B.getRotationZ()),o=w({x:t,y:e,z:r},n);o={x:o.x-Z.getPositionX()-a.A*Z.getDimension()/2,y:o.y-Z.getPositionY()-a.B*Z.getDimension()/2,z:o.z-Z.getPositionZ()-a.C*Z.getDimension()/2};var m=p(g(o.x,2)+g(o.y,2)+g(o.z,2)),c=1===i(a.C)?a.C*o.z:1===i(a.B)?a.B*o.y:a.A*o.x,l=s(i(o.x*a.A+o.y*a.B+o.z*a.C)/m);return{angle:l,direction:c,distance:m}}function w(t,e){var r=[[t.x],[t.y],[t.z]],a=d(e,r);return{x:a[0][0],y:a[1][0],z:a[2][0]}}function x(){var t=M.getFaces();for(var e in T){var r=t[e];if(r instanceof k)T[e].src=r.getSource(),T[e].removeAttribute("class");else if(r instanceof u){var a=T[e].parentElement;a.style.background="#"+r.getHex(),T[e].setAttribute("class","colored")}}}function E(){P=L("div","cube"),F=L("div","anim"),y("top"),y("bottom"),y("front"),y("back"),y("left"),y("right"),P.appendChild(F)}function y(t){var e=function(t){return t+"px"},r=D/2,a=Z,o=L("img",""),i=L("div","shader"),s=L("div","face "+t);T[t]=n(o,{shader:i}),n(s.style,{width:e(D),height:e(D),marginLeft:e(-1*r),marginTop:e(-1*r),transform:{top:"rotateX(90deg) translateZ("+r+"px)",bottom:"rotateX(90deg) translateZ(-"+r+"px)",left:"rotateY(90deg) translateZ(-"+r+"px)",right:"rotateY(90deg) translateZ("+r+"px)",front:"translateZ("+r+"px)",back:"translateZ(-"+r+"px)"}[t]}),s.addEventListener("click",{top:function top(){return Z.triggerEvent("TopClick",{target:a})},bottom:function bottom(){return Z.triggerEvent("BottomClick",{target:a})},left:function left(){return Z.triggerEvent("LeftClick",{target:a})},right:function right(){return Z.triggerEvent("RightClick",{target:a})},front:function front(){return Z.triggerEvent("FrontClick",{target:a})},back:function back(){return Z.triggerEvent("BackClick",{target:a})}}[t]),s.addEventListener("contextmenu",S),s.appendChild(o),s.appendChild(i),F.appendChild(s)}function L(t,e){var r=document.createElement(t);return r.setAttribute("class",e),r}function A(){var t=Z.getPosition();P.style.transform="translate3d("+t.x+"px, "+-t.y+"px, "+t.z+"px)"}function z(){B.add(Z)}function C(){x(),Z.triggerEvent("MeshChange",{target:Z,mesh:M})}function S(t){return t.preventDefault(),Z.triggerEvent("VoxelClick",{target:Z}),!1}var P,F,M,B,Z=this,T={},D=0;n(Z,{setMesh:t,getMesh:function(){return M},animUp:function(t){if(t===void 0)throw"Scene required to add voxel to scene";B=t,F.setAttribute("class","anim up"),z()},animDown:function(t){if(t===void 0)throw"Scene required to add voxel to scene";B=t,F.setAttribute("class","anim down"),z()},addToScene:function(t){if(t===void 0)throw"Scene required to add voxel to scene";B=t,F.setAttribute("class","anim"),z()},removeFromScene:function(){void 0===B||B.remove(Z)},setParentScene:function(t){B=t},removeParentScene:function(){B=void 0},setDimension:e,getDimension:function(){return D},getDomElement:function(){return P},updateLightSource:function(t){var e=function(t){return g(t,3)},a=1,n=1,i=1,s=1,x=1,p=1;t.forEach(function(t){var o=[t.getPositionX(),t.getPositionY(),t.getPositionZ()],d=t.getBrightness(),f=t.getTravelDistance(),v=d[1]-d[0],b=1-d[1],h=function(t){var a=_slicedToArray(t,3),n=a[0],i=a[1],s=a[2],m=r.apply(void 0,o.concat([{A:n,B:i,C:s}])),x=m.angle,p=m.direction,d=m.distance,h=0>p?1:c(1,e(1-x/(l/2))+g(d/f,6));return 1-(h*v+b)};n=m(0,n-h([0,0,-1])),a=m(0,a-h([0,0,1])),i=m(0,i-h([-1,0,0])),s=m(0,s-h([1,0,0])),x=m(0,x-h([0,1,0])),p=m(0,p-h([0,-1,0]))});var d={front:a,back:n,left:i,right:s,top:x,bottom:p};o(d).forEach(function(t){T[t].shader.style.opacity=d[t]})},clone:function(){return new a(Z.getPositionX(),Z.getPositionY(),Z.getPositionZ(),D,{mesh:M})}}),function(r,a,n,o,i){b(v(Z)),Z.addEventListener("move",A),e(o),E(),Z.setPosition(r,a,n),t(new h),i!==void 0&&i.mesh!==void 0&&t(i.mesh)}.apply(Z,arguments)}var n=Object.assign,o=Object.keys,i=Math.abs,s=Math.asin,m=Math.max,c=Math.min,l=t,g=Math.pow,p=Math.sqrt,x=e("./common"),d=x.multiplyMatrices,f=x.generateRotationMatrix,v=e("./eventListener"),b=e("./positioned"),h=e("./Mesh"),k=e("./ImageFace"),u=e("./ColorFace");r.exports=a},{"./ColorFace":2,"./ImageFace":4,"./Mesh":6,"./common":10,"./eventListener":11,"./positioned":14}],9:[function(t,e){"use strict";var r=t("./Mesh"),a=t("./Voxel");e.exports=function(){function t(t){return x.push(t),m.add(t)}function e(t){var e=x.indexOf(t);return!(0>e)&&(m.remove(t),x.splice(e,1),!0)}function n(){for(var t,e=[],r=0;t=x[r++];)e.push({position:t.getPosition(),dimension:t.getDimension(),mesh:t.getMesh().serialize()});return JSON.stringify(e)}function o(e){s();for(var n,o,m=JSON.parse(e+""),c=0;n=m[c++];)o=new a(n.position.x,n.position.y,n.position.z,n.dimension),o.setMesh(r.loadFromSerial(n.mesh)),t(o)}function s(){for(;0<x.length;)e(x[0])}function i(){return"savedWorld<"+l+">"}var m,c=this,l="*",x=[];c.add=t,c.remove=e,c.export=n,c.import=o,c.save=function(){localStorage.setItem(i(),n())},c.load=function(){o(localStorage.getItem(i())||"[]")},c.isSaved=function(){return!!localStorage.getItem(i())},c.deleteSave=function(){localStorage.setItem(i(),"")},c.getScene=function(){return m},c.getVoxels=function(){return x.concat([])},function(t,e){if(t===void 0)throw"World cannot be instantiated without a Scene instance";m=t,e!==void 0&&(l=e)}.apply(c,arguments)}},{"./Mesh":6,"./Voxel":8}],10:[function(t,e){"use strict";function r(t,e){for(var a=t.length,n=t[0].length,o=e[0].length,s=Array(a),m=0;m<a;++m){s[m]=Array(o);for(var r=0;r<o;++r){s[m][r]=0;for(var c=0;c<n;++c)s[m][r]+=t[m][c]*e[c][r]}}return s}var a=Math.cos,n=Math.sin,o=16;e.exports={hexToRgb:function(t){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(e,function(t,e,r,a){return e+e+r+r+a+a});var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return r?{r:parseInt(r[1],o),g:parseInt(r[2],o),b:parseInt(r[3],o)}:null},rgbToHex:function(t,e,r){return""+(16777216+(t<<16)+(e<<8)+r).toString(16).slice(1)},generateRotationMatrix:function(t,e,o){var i=[[1,0,0],[0,a(t),-n(t)],[0,n(t),a(t)]],s=[[a(e),0,n(e)],[0,1,0],[-n(e),0,a(e)]],m=[[a(o),-n(o),0],[n(o),a(o),0],[0,0,1]];return r(r(m,s),i)},multiplyMatrices:r}},{}],11:[function(t,e){"use strict";e.exports=function(t){var e=t||new Function,r={};return Object.assign(e,{addEventListener:function(t,e){(t="on"+t,"function"==typeof e)&&(r[t]||(r[t]=[]),-1<r[t].indexOf(e)||r[t].push(e))},removeEventListener:function(t,e){t="on"+t,r[t]&&r[t].splice(r[t].indexOf(e),1)},triggerEvent:function(t,e){t="on"+t;var a=r[t];if(a)for(var n,o=0;n=a[o++];)n(e)}}),e}},{}],12:[function(t,e){"use strict";t("../dist/voxelcss.css");var r=t("./ColorFace"),a=t("./Editor"),n=t("./eventListener"),o=t("./ImageFace"),i=t("./LightSource"),s=t("./Mesh"),m=t("./meshes"),c=t("./positioned"),l=t("./Scene"),x=t("./Voxel"),g=t("./World");e.exports={ColorFace:r,Editor:a,eventListener:n,ImageFace:o,LightSource:i,Mesh:s,meshes:m,Positioned:c,Scene:l,Voxel:x,World:g}},{"../dist/voxelcss.css":1,"./ColorFace":2,"./Editor":3,"./ImageFace":4,"./LightSource":5,"./Mesh":6,"./Scene":7,"./Voxel":8,"./World":9,"./eventListener":11,"./meshes":13,"./positioned":14}],13:[function(t,e){"use strict";var r=t("./Mesh"),a=t("./ImageFace");e.exports={dirt:new r(new a("http://voxelcss.com/res/dirt/main.png")),grass:new r({top:new a("http://voxelcss.com/res/grass/top.png"),bottom:new a("http://voxelcss.com/res/grass/bottom.png"),front:new a("http://voxelcss.com/res/grass/side.png"),back:new a("http://voxelcss.com/res/grass/side.png"),left:new a("http://voxelcss.com/res/grass/side.png"),right:new a("http://voxelcss.com/res/grass/side.png")}),water:new r(new a("http://voxelcss.com/res/water/main.png")),waterFall:new r({top:new a("http://voxelcss.com/res/water/main.png"),bottom:new a("http://voxelcss.com/res/water/main.png"),front:new a("http://voxelcss.com/res/water/fall.png"),back:new a("http://voxelcss.com/res/water/fall.png"),left:new a("http://voxelcss.com/res/water/fall.png"),right:new a("http://voxelcss.com/res/water/fall.png")}),waterFallTop:new r({top:new a("http://voxelcss.com/res/water/main.png"),bottom:new a("http://voxelcss.com/res/water/main.png"),front:new a("http://voxelcss.com/res/water/falltop.png"),back:new a("http://voxelcss.com/res/water/falltop.png"),left:new a("http://voxelcss.com/res/water/falltop.png"),right:new a("http://voxelcss.com/res/water/falltop.png")}),waterFallCrash:new r({top:new a("http://voxelcss.com/res/water/main.png"),bottom:new a("http://voxelcss.com/res/water/main.png"),front:new a("http://voxelcss.com/res/water/crash.png"),back:new a("http://voxelcss.com/res/water/crash.png"),left:new a("http://voxelcss.com/res/water/crash.png"),right:new a("http://voxelcss.com/res/water/crash.png")}),treeTrunk:new r({top:new a("http://voxelcss.com/res/tree/rings.png"),bottom:new a("http://voxelcss.com/res/tree/rings.png"),front:new a("http://voxelcss.com/res/tree/bark.png"),back:new a("http://voxelcss.com/res/tree/bark.png"),left:new a("http://voxelcss.com/res/tree/bark.png"),right:new a("http://voxelcss.com/res/tree/bark.png")}),treeLeaves:new r(new a("http://voxelcss.com/res/tree/leaves.png"))}},{"./ImageFace":4,"./Mesh":6}],14:[function(t,e){"use strict";e.exports=function(t){function e(t){if(void 0===t||"number"!=typeof t)return m.x;var e=m.x;return m.x=t,c&&s.triggerEvent("move"),e}function r(t){if(void 0===t||"number"!=typeof t)return m.y;var e=m.y;return m.y=t,c&&s.triggerEvent("move"),e}function a(t){if(void 0===t||"number"!=typeof t)return m.z;var e=m.z;return m.z=t,c&&s.triggerEvent("move"),e}function n(t){return void 0===t||"number"!=typeof t?m.x:e(t+m.x)}function o(t){return void 0===t||"number"!=typeof t?m.y:r(t+m.y)}function i(t){return void 0===t||"number"!=typeof t?m.z:a(t+m.z)}var s=t||new Function,m={x:0,y:0,z:0},c=!0;return Object.assign(s,{setPosition:function(t,n,o){c=!1;var i={x:e(t),y:r(n),z:a(o)};return c=!0,s.triggerEvent("move"),i},setPositionX:e,setPositionY:r,setPositionZ:a,getPosition:function(){return{x:m.x,y:m.y,z:m.z}},getPositionX:function(){return m.x},getPositionY:function(){return m.y},getPositionZ:function(){return m.z},translate:function(t,e,r){c=!1;var a={x:n(t),y:o(e),z:i(r)};return c=!0,s.triggerEvent("move"),a},translateX:n,translateY:o,translateZ:i}),s}},{}],15:[function(t,e){"use strict";var r=[],a=function(t,e){var a=document.head||document.getElementsByTagName("head")[0],n=r[r.length-1];if(e=e||{},e.insertAt=e.insertAt||"bottom","top"===e.insertAt)n?n.nextSibling?a.insertBefore(t,n.nextSibling):a.appendChild(t):a.insertBefore(t,a.firstChild),r.push(t);else if("bottom"===e.insertAt)a.appendChild(t);else throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.")};e.exports={createLink:function createLink(t,e){var r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("link");for(var n in a.href=t,a.rel="stylesheet",e)if(e.hasOwnProperty(n)){var o=e[n];a.setAttribute("data-"+n,o)}r.appendChild(a)},createStyle:function createStyle(t,e,r){r=r||{};var n=document.createElement("style");for(var o in n.type="text/css",e)if(e.hasOwnProperty(o)){var i=e[o];n.setAttribute("data-"+o,i)}n.sheet?(n.innerHTML=t,n.sheet.cssText=t,a(n,{insertAt:r.insertAt})):n.styleSheet?(a(n,{insertAt:r.insertAt}),n.styleSheet.cssText=t):(n.appendChild(document.createTextNode(t)),a(n,{insertAt:r.insertAt}))}}},{}]},{},[12])(12)});
