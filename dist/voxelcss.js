"use strict";var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}(function(a){if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window,b.voxelcss=a()}})(function(){var a=Math.PI;return function b(c,d,e){function a(h,i){if(!d[h]){if(!c[h]){var j="function"==typeof require&&require;if(!i&&j)return j(h,!0);if(g)return g(h,!0);var k=new Error("Cannot find module '"+h+"'");throw k.code="MODULE_NOT_FOUND",k}var f=d[h]={exports:{}};c[h][0].call(f.exports,function(b){var d=c[h][1][b];return a(d?d:b)},f,f.exports,b,c,d,e)}return d[h].exports}for(var g="function"==typeof require&&require,f=0;f<e.length;f++)a(e[f]);return a}({1:[function(a,b){var c=".voxelcss-scene {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-perspective: 1000px;\n  perspective: 1000px;\n  -webkit-perspective-origin: 50% 50%;\n  perspective-origin: 50% 50%;\n  cursor: move;\n}\n.voxelcss-scene .camera,\n.voxelcss-scene .zoom {\n  top: 50%;\n  left: 50%;\n  width: 0;\n  height: 0;\n  overflow: visible;\n}\n.voxelcss-cube,\n.voxelcss-scene .camera,\n.voxelcss-scene .zoom {\n  position: absolute;\n  -webkit-transform-style: preserve-3d;\n  transform-style: preserve-3d;\n}\n.voxelcss-cube:hover img {\n  visibility: hidden!important;\n}\n.voxelcss-cube:hover .voxelcss-face {\n  background: rgba(0,0,0,.3)!important;\n}\n.voxelcss-cube:hover .voxelcss-face .shader {\n  opacity: 0!important;\n}\n.voxelcss-cube .animated-down,\n.voxelcss-cube .animated-up {\n  -webkit-transform-style: preserve-3d;\n  transform-style: preserve-3d;\n}\n.voxelcss-cube .animated-up {\n  -webkit-animation: a 1s linear both;\n  animation: a 1s linear both;\n}\n.voxelcss-cube .animated-down {\n  -webkit-animation: b 1s linear both;\n  animation: b 1s linear both;\n}\n.voxelcss-face {\n  display: block;\n  position: absolute;\n  outline: none;\n  border: none;\n  margin-left: -18px;\n  margin-top: -18px;\n  width: 36px;\n  height: 36px;\n  cursor: pointer;\n}\n.voxelcss-face img {\n  width: 100%;\n  height: 100%;\n}\n.voxelcss-face img.colored {\n  visibility: hidden;\n}\n.voxelcss-face .shader {\n  display: block;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: #000;\n  opacity: 0;\n}\n@-webkit-keyframes a {\n  0% {\n    opacity: 0;\n    -webkit-transform: matrix(1,0,0,1,0,300);\n    transform: matrix(1,0,0,1,0,300);\n  }\n\n  1.3% {\n    -webkit-transform: matrix(1,0,0,3.905,0,237.02);\n    transform: matrix(1,0,0,3.905,0,237.02);\n  }\n\n  2.55% {\n    -webkit-transform: matrix(1,0,0,4.554,0,182.798);\n    transform: matrix(1,0,0,4.554,0,182.798);\n  }\n\n  4.1% {\n    -webkit-transform: matrix(1,0,0,4.025,0,125.912);\n    transform: matrix(1,0,0,4.025,0,125.912);\n  }\n\n  5.71% {\n    -webkit-transform: matrix(1,0,0,3.039,0,79.596);\n    transform: matrix(1,0,0,3.039,0,79.596);\n  }\n\n  8.11% {\n    opacity: 1;\n    -webkit-transform: matrix(1,0,0,1.82,0,31.647);\n    transform: matrix(1,0,0,1.82,0,31.647);\n  }\n\n  8.81% {\n    -webkit-transform: matrix(1,0,0,1.581,0,21.84);\n    transform: matrix(1,0,0,1.581,0,21.84);\n  }\n\n  11.96% {\n    -webkit-transform: matrix(1,0,0,1.034,0,-4.825);\n    transform: matrix(1,0,0,1.034,0,-4.825);\n  }\n\n  12.11% {\n    -webkit-transform: matrix(1,0,0,1.023,0,-5.53);\n    transform: matrix(1,0,0,1.023,0,-5.53);\n  }\n\n  15.07% {\n    -webkit-transform: matrix(1,0,0,.947,0,-12.662);\n    transform: matrix(1,0,0,.947,0,-12.662);\n  }\n\n  16.12% {\n    -webkit-transform: matrix(1,0,0,.951,0,-13.007);\n    transform: matrix(1,0,0,.951,0,-13.007);\n  }\n\n  27.23% {\n    -webkit-transform: matrix(1,0,0,1.001,0,-2.352);\n    transform: matrix(1,0,0,1.001,0,-2.352);\n  }\n\n  27.58% {\n    -webkit-transform: matrix(1,0,0,1.001,0,-2.121);\n    transform: matrix(1,0,0,1.001,0,-2.121);\n  }\n\n  38.34% {\n    -webkit-transform: matrix(1,0,0,1,0,.311);\n    transform: matrix(1,0,0,1,0,.311);\n  }\n\n  40.09% {\n    -webkit-transform: matrix(1,0,0,1,0,.291);\n    transform: matrix(1,0,0,1,0,.291);\n  }\n\n  50% {\n    -webkit-transform: matrix(1,0,0,1,0,.048);\n    transform: matrix(1,0,0,1,0,.048);\n  }\n\n  60.56% {\n    -webkit-transform: matrix(1,0,0,1,0,-.007);\n    transform: matrix(1,0,0,1,0,-.007);\n  }\n\n  82.78% {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n\n  to {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n}\n@keyframes a {\n  0% {\n    opacity: 0;\n    -webkit-transform: matrix(1,0,0,1,0,300);\n    transform: matrix(1,0,0,1,0,300);\n  }\n\n  1.3% {\n    -webkit-transform: matrix(1,0,0,3.905,0,237.02);\n    transform: matrix(1,0,0,3.905,0,237.02);\n  }\n\n  2.55% {\n    -webkit-transform: matrix(1,0,0,4.554,0,182.798);\n    transform: matrix(1,0,0,4.554,0,182.798);\n  }\n\n  4.1% {\n    -webkit-transform: matrix(1,0,0,4.025,0,125.912);\n    transform: matrix(1,0,0,4.025,0,125.912);\n  }\n\n  5.71% {\n    -webkit-transform: matrix(1,0,0,3.039,0,79.596);\n    transform: matrix(1,0,0,3.039,0,79.596);\n  }\n\n  8.11% {\n    opacity: 1;\n    -webkit-transform: matrix(1,0,0,1.82,0,31.647);\n    transform: matrix(1,0,0,1.82,0,31.647);\n  }\n\n  8.81% {\n    -webkit-transform: matrix(1,0,0,1.581,0,21.84);\n    transform: matrix(1,0,0,1.581,0,21.84);\n  }\n\n  11.96% {\n    -webkit-transform: matrix(1,0,0,1.034,0,-4.825);\n    transform: matrix(1,0,0,1.034,0,-4.825);\n  }\n\n  12.11% {\n    -webkit-transform: matrix(1,0,0,1.023,0,-5.53);\n    transform: matrix(1,0,0,1.023,0,-5.53);\n  }\n\n  15.07% {\n    -webkit-transform: matrix(1,0,0,.947,0,-12.662);\n    transform: matrix(1,0,0,.947,0,-12.662);\n  }\n\n  16.12% {\n    -webkit-transform: matrix(1,0,0,.951,0,-13.007);\n    transform: matrix(1,0,0,.951,0,-13.007);\n  }\n\n  27.23% {\n    -webkit-transform: matrix(1,0,0,1.001,0,-2.352);\n    transform: matrix(1,0,0,1.001,0,-2.352);\n  }\n\n  27.58% {\n    -webkit-transform: matrix(1,0,0,1.001,0,-2.121);\n    transform: matrix(1,0,0,1.001,0,-2.121);\n  }\n\n  38.34% {\n    -webkit-transform: matrix(1,0,0,1,0,.311);\n    transform: matrix(1,0,0,1,0,.311);\n  }\n\n  40.09% {\n    -webkit-transform: matrix(1,0,0,1,0,.291);\n    transform: matrix(1,0,0,1,0,.291);\n  }\n\n  50% {\n    -webkit-transform: matrix(1,0,0,1,0,.048);\n    transform: matrix(1,0,0,1,0,.048);\n  }\n\n  60.56% {\n    -webkit-transform: matrix(1,0,0,1,0,-.007);\n    transform: matrix(1,0,0,1,0,-.007);\n  }\n\n  82.78% {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n\n  to {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n}\n@-webkit-keyframes b {\n  0% {\n    opacity: 0;\n    -webkit-transform: matrix(1,0,0,1,0,-300);\n    transform: matrix(1,0,0,1,0,-300);\n  }\n\n  1.3% {\n    -webkit-transform: matrix(1,0,0,3.905,0,-237.02);\n    transform: matrix(1,0,0,3.905,0,-237.02);\n  }\n\n  2.55% {\n    -webkit-transform: matrix(1,0,0,4.554,0,-182.798);\n    transform: matrix(1,0,0,4.554,0,-182.798);\n  }\n\n  4.1% {\n    -webkit-transform: matrix(1,0,0,4.025,0,-125.912);\n    transform: matrix(1,0,0,4.025,0,-125.912);\n  }\n\n  5.71% {\n    -webkit-transform: matrix(1,0,0,3.039,0,-79.596);\n    transform: matrix(1,0,0,3.039,0,-79.596);\n  }\n\n  8.11% {\n    opacity: 1;\n    -webkit-transform: matrix(1,0,0,1.82,0,-31.647);\n    transform: matrix(1,0,0,1.82,0,-31.647);\n  }\n\n  8.81% {\n    -webkit-transform: matrix(1,0,0,1.581,0,-21.84);\n    transform: matrix(1,0,0,1.581,0,-21.84);\n  }\n\n  11.96% {\n    -webkit-transform: matrix(1,0,0,1.034,0,4.825);\n    transform: matrix(1,0,0,1.034,0,4.825);\n  }\n\n  12.11% {\n    -webkit-transform: matrix(1,0,0,1.023,0,5.53);\n    transform: matrix(1,0,0,1.023,0,5.53);\n  }\n\n  15.07% {\n    -webkit-transform: matrix(1,0,0,.947,0,12.662);\n    transform: matrix(1,0,0,.947,0,12.662);\n  }\n\n  16.12% {\n    -webkit-transform: matrix(1,0,0,.951,0,13.007);\n    transform: matrix(1,0,0,.951,0,13.007);\n  }\n\n  27.23% {\n    -webkit-transform: matrix(1,0,0,1.001,0,2.352);\n    transform: matrix(1,0,0,1.001,0,2.352);\n  }\n\n  27.58% {\n    -webkit-transform: matrix(1,0,0,1.001,0,2.121);\n    transform: matrix(1,0,0,1.001,0,2.121);\n  }\n\n  38.34% {\n    -webkit-transform: matrix(1,0,0,1,0,-.311);\n    transform: matrix(1,0,0,1,0,-.311);\n  }\n\n  40.09% {\n    -webkit-transform: matrix(1,0,0,1,0,-.291);\n    transform: matrix(1,0,0,1,0,-.291);\n  }\n\n  50% {\n    -webkit-transform: matrix(1,0,0,1,0,-.048);\n    transform: matrix(1,0,0,1,0,-.048);\n  }\n\n  60.56% {\n    -webkit-transform: matrix(1,0,0,1,0,.007);\n    transform: matrix(1,0,0,1,0,.007);\n  }\n\n  82.78% {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n\n  to {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n}\n@keyframes b {\n  0% {\n    opacity: 0;\n    -webkit-transform: matrix(1,0,0,1,0,-300);\n    transform: matrix(1,0,0,1,0,-300);\n  }\n\n  1.3% {\n    -webkit-transform: matrix(1,0,0,3.905,0,-237.02);\n    transform: matrix(1,0,0,3.905,0,-237.02);\n  }\n\n  2.55% {\n    -webkit-transform: matrix(1,0,0,4.554,0,-182.798);\n    transform: matrix(1,0,0,4.554,0,-182.798);\n  }\n\n  4.1% {\n    -webkit-transform: matrix(1,0,0,4.025,0,-125.912);\n    transform: matrix(1,0,0,4.025,0,-125.912);\n  }\n\n  5.71% {\n    -webkit-transform: matrix(1,0,0,3.039,0,-79.596);\n    transform: matrix(1,0,0,3.039,0,-79.596);\n  }\n\n  8.11% {\n    opacity: 1;\n    -webkit-transform: matrix(1,0,0,1.82,0,-31.647);\n    transform: matrix(1,0,0,1.82,0,-31.647);\n  }\n\n  8.81% {\n    -webkit-transform: matrix(1,0,0,1.581,0,-21.84);\n    transform: matrix(1,0,0,1.581,0,-21.84);\n  }\n\n  11.96% {\n    -webkit-transform: matrix(1,0,0,1.034,0,4.825);\n    transform: matrix(1,0,0,1.034,0,4.825);\n  }\n\n  12.11% {\n    -webkit-transform: matrix(1,0,0,1.023,0,5.53);\n    transform: matrix(1,0,0,1.023,0,5.53);\n  }\n\n  15.07% {\n    -webkit-transform: matrix(1,0,0,.947,0,12.662);\n    transform: matrix(1,0,0,.947,0,12.662);\n  }\n\n  16.12% {\n    -webkit-transform: matrix(1,0,0,.951,0,13.007);\n    transform: matrix(1,0,0,.951,0,13.007);\n  }\n\n  27.23% {\n    -webkit-transform: matrix(1,0,0,1.001,0,2.352);\n    transform: matrix(1,0,0,1.001,0,2.352);\n  }\n\n  27.58% {\n    -webkit-transform: matrix(1,0,0,1.001,0,2.121);\n    transform: matrix(1,0,0,1.001,0,2.121);\n  }\n\n  38.34% {\n    -webkit-transform: matrix(1,0,0,1,0,-.311);\n    transform: matrix(1,0,0,1,0,-.311);\n  }\n\n  40.09% {\n    -webkit-transform: matrix(1,0,0,1,0,-.291);\n    transform: matrix(1,0,0,1,0,-.291);\n  }\n\n  50% {\n    -webkit-transform: matrix(1,0,0,1,0,-.048);\n    transform: matrix(1,0,0,1,0,-.048);\n  }\n\n  60.56% {\n    -webkit-transform: matrix(1,0,0,1,0,.007);\n    transform: matrix(1,0,0,1,0,.007);\n  }\n\n  82.78% {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n\n  to {\n    -webkit-transform: matrix(1,0,0,1,0,0);\n    transform: matrix(1,0,0,1,0,0);\n  }\n}\n";a("browserify-css").createStyle(c,{href:"dist/voxelcss.css"},{insertAt:"bottom"}),b.exports=c},{"browserify-css":15}],2:[function(a,b){"use strict";function c(){function a(){var c=arguments[0],d="undefined"==typeof c?"undefined":_typeof(c),f=e,h=c;if(1===arguments.length&&"number"!==d)"string"===d&&(f=function(b){return a(g(b))});else{var i=Array.prototype.slice.call(arguments),j=i[0],k=i[1],l=i[2],m=i[3];h={r:j,g:k,b:l,a:m}}f(h)}function e(c){var e=c.r,i=c.g,j=c.b,m=c.a;if([e,i,j].every(f))return l.triggerEvent("change",{target:l}),d(k,{r:e,g:i,b:j,a:f(m)?m:1});if([e,i,j].every(h))return k;throw"Face color RGB values must be numbers"}var k={r:0,g:0,b:0,a:1},l=d(j(this),{setColor:a,getColor:function getColor(){return k},getHex:function getHex(){return i(k)},clone:function clone(){return new c(k)},serialize:function serialize(){return JSON.stringify(k)}});a.apply(void 0,arguments)}var d=Object.assign,e=a("./common"),f=e.isNumber,h=e.isUndefined,g=e.hexToRgb,i=e.rgbToHex,j=a("./eventListener");b.exports=c,c.loadFromSerial=function(a){var b=JSON.parse(a);return new c(b)}},{"./common":10,"./eventListener":11}],3:[function(a,b){"use strict";b.exports=function(a,b){function c(b){return j(b),a.add(b),g.canAutoSave()&&a.save(),g}function d(b){return a.remove(b)&&k(b),g.canAutoSave()&&a.save(),g}function f(a,b){if(g.isEnabled()){var d,e=a.target,f=e.getDimension();b=b.map(function(a){return a*f}),c((d=e.clone()).translate.apply(d,_toConsumableArray(b)))}}if(a===void 0)throw"Editor requires World instance for initialization";var g=this,e=b!==void 0&&!0===b.autosave,h=!0,i=[["VoxelClick",function onVoxelClick(a){return g.isEnabled()&&d(a.target)}],["MeshChange",function onMeshChange(){return g.canAutoSave()&&g.save()}],["TopClick",function onTopClick(a){return f(a,[0,1,0])}],["BottomClick",function onBottomClick(a){return f(a,[0,-1,0])}],["FrontClick",function onFrontClick(a){return f(a,[0,0,1])}],["BackClick",function onBackClick(a){return f(a,[0,0,-1])}],["LeftClick",function onLeftClick(a){return f(a,[-1,0,0])}],["RightClick",function onRightClick(a){return f(a,[1,0,0])}]],j=function(a){return i.forEach(function(b){return a.addEventListener.apply(a,_toConsumableArray(b))})},k=function(a){return i.forEach(function(b){return a.removeEventListener.apply(a,_toConsumableArray(b))})},l=function(){return a.getVoxels().forEach(function(a){return j(a)})};Object.assign(g,{add:c,remove:d,getWorld:function getWorld(){return a},isEnabled:function isEnabled(){return h},enable:function enable(){return h=!0},disable:function disable(){return h=!1},canAutoSave:function canAutoSave(){return e},enableAutoSave:function enableAutoSave(){return e=!0},disableAutoSave:function disableAutoSave(){return e=!1},isSaved:function isSaved(){return a.isSaved()},deleteSave:function deleteSave(){return a.deleteSave()},export:function _export(){return a.export()},import:function _import(b){a.import(b),l()},save:function save(){return a.save()},load:function load(){a.load(),l()}}),l()}},{}],4:[function(a,b){"use strict";function c(a){function b(a){return a&&(g=a,i.triggerEvent("change",{target:i})),g}var g=f,h=function(){return g},i=d(e(this),{setSource:b,getSource:h,serialize:h,clone:function clone(){return new c(g)}});b(a)}var d=Object.assign,e=a("./eventListener"),f="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";b.exports=c,c.loadFromSerial=function(a){return new c(a)}},{"./eventListener":11}],5:[function(a,b){"use strict";var c=Object.assign,d=a("./common"),e=d.isNumber,f=a("./eventListener"),g=a("./positioned");b.exports=function(a,b){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0.2,h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:1,i=500,j=1,k=0,l=c(g(f(this)),{setBrightness:function(a,b){return e(b)&&(j=b),e(a)&&(k=a),[a,b].some(e)&&l.triggerEvent("change",{target:l}),l},getBrightness:function getBrightness(){return[k,j]},setTravelDistance:function(a){return e(a)&&(i=a,l.triggerEvent("change",{target:l})),l},getTravelDistance:function getTravelDistance(){return i}});l.setPosition(a).setTravelDistance(b).setBrightness(d,h)}},{"./common":10,"./eventListener":11,"./positioned":14}],6:[function(a,b){"use strict";function c(a){function b(a){return h(m,a)}function c(a){return!!b(a.constructor)}function d(a){var b=f();if(a){c(a)&&(a=i(f(),g(a))),v=!1;var d=a,e=d.front,h=d.back,j=d.left,k=d.right,l=d.top,m=d.bottom;x.setFront(e).setBack(h).setLeft(j).setRight(k).setTop(l).setBottom(m),o(),v=!0}return b}function f(){return{front:p,back:q,left:r,right:s,top:t,bottom:u}}function l(a){return b(a.constructor)+"("+a.serialize()+")"}function n(){o()}function o(){var a=f();x.triggerEvent("change",{target:x,faces:a})}var p,q,r,s,t,u,v=!0,w=function(a){return a!==void 0&&c(a)},x=e(j(this),{setFront:function(a){return w(a)&&(p=a,p.addEventListener("change",n),v&&o()),x},setBack:function(a){return w(a)&&(q=a,q.addEventListener("change",n),v&&o()),x},setLeft:function(a){return w(a)&&(r=a,r.addEventListener("change",n),v&&o()),x},setRight:function(a){return w(a)&&(s=a,s.addEventListener("change",n),v&&o()),x},setTop:function(a){return w(a)&&(t=a,t.addEventListener("change",n),v&&o()),x},setBottom:function(a){return w(a)&&(u=a,u.addEventListener("change",n),v&&o()),x},setFaces:d,getFaces:f,serialize:function(){return JSON.stringify(i(f(),l))},getFront:function getFront(){return p},getBack:function getBack(){return q},getLeft:function getLeft(){return r},getRight:function getRight(){return s},getTop:function getTop(){return t},getBottom:function getBottom(){return u}});d(a||new k)}function d(a){var b=a.indexOf("("),c=a.slice(0,b),d=a.slice(b+1,-1);return m[c].loadFromSerial(d)}var e=Object.assign,f=a("./common"),g=f.constant,h=f.findKeyWithValue,i=f.mapValues,j=a("./eventListener"),k=a("./ImageFace"),l=a("./ColorFace"),m={image:k,color:l};b.exports=c,c.loadFromSerial=function(a){return new c(i(JSON.parse(a),d))}},{"./ColorFace":2,"./ImageFace":4,"./common":10,"./eventListener":11}],7:[function(b,c){"use strict";var d=Object.assign,e=b("./common"),f=e.isNumber,g=e.isShiftKey,h=e.not,i=b("./eventListener"),j=function(a){return a.x||a.clientX},k=function(a){return a.y||a.clientY};c.exports=function(){function b(a,b){return f(b)&&(O[a]+=b,E()),Y}function c(a,b){return f(b)&&(O[a]=b,E()),Y}function e(a,b,c){l("x",a),l("y",b),l("z",c)}function l(a,b){return f(b)&&(P[a]+=b,E()),Y}function m(a,b){return f(b)&&(P[a]=b,E()),Y}function n(){return P}function o(a){return f(a)&&(Q+=a,E()),Y}function p(){return Q}function q(a){var b=j(a),c=k(a);R.start={x:b,y:c},R.current={x:b,y:c},window.addEventListener("mousemove",t),window.addEventListener("mouseup",r)}function r(){A()}function s(){return{rotation:X(),pan:n(),zoom:p(),target:Y}}function t(b){var c=j(b),d=k(b),f=c-R.current.x,g=d-R.current.y;if(R.current={x:c,y:d},R.lastMove={dx:f,dy:g},T&&R.shiftDown)e(f,g),E(),Y.triggerEvent("pan",s());else if(S){var h=2*a*2;O.y+=f/window.innerWidth*h,O.x-=g/window.innerHeight*h,E(),Y.triggerEvent("rotate",s())}}function u(a){if(U){o(a.deltaY/500),a.preventDefault(),Y.triggerEvent("zoom",s())}return!1}function v(){H.addEventListener("mousedown",q),H.addEventListener("mousewheel",u),H.addEventListener("wheel",u)}function w(){window.addEventListener("keydown",C),window.addEventListener("keyup",D)}function A(){window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",r)}function B(){window.removeEventListener("keydown",C),window.removeEventListener("keyup",D)}function C(a){R.shiftDown=g(a)}function D(a){R.shiftDown=h(g)(a)}function E(){var a=X(),b=a.x,c=a.y,d=a.z,e=p(),f=n();J.style.transform="rotateX("+b+"rad) rotateY("+c+"rad) rotateZ("+d+"rad)",I.style.transform="scale("+e+", "+e+") translateX("+f.x+"px) translateY("+f.y+"px) translateZ("+f.z+"px)",F()}function F(){0!==V.length&&W.forEach(function(a){return a.updateLightSource(V)})}var G,H,I,J,K=!1,L=0,M=0,N=0,O={x:L,y:M,z:N},P={x:L,y:M,z:N},Q=1,R={start:{x:L,y:M},current:{x:L,y:M},lastMove:{x:L,y:M},shiftDown:!1},S=!0,T=!0,U=!0,V=[],W=[],X=function(){return O},Y=d(i(this),{attach:function(a){if(!K)G=a,a.appendChild(H),K=!0;else throw"Cannot attach currently attached scene"},detach:function(){if(K){K=!1;var a=H,b=a.parentElement;b&&b.removeChild(H)}else throw"Cannot detach currently detached scene"},add:function(a){J.appendChild(a.getDomElement()),W.push(a),a.setParentScene(Y),0!==V.length&&a.updateLightSource(V)},remove:function(a){J.removeChild(a.getDomElement()),W.splice(W.indexOf(a),1),a.removeParentScene()},getVoxels:function getVoxels(){return W},pan:e,setPan:function(a,b,c){return m("x",a),m("y",b),m("z",c),E(),Y},getPan:n,rotate:function(a,c,d){return b("x",a),b("y",c),b("z",d),Y},setRotation:function(a,b,d){return c("x",a),c("y",b),c("z",d),E(),Y},getRotation:X,zoom:o,setZoom:function(a){return f(a)&&(Q=a,E()),Y},getZoom:p,addLightSource:function(a){var b=V.indexOf(a);return!(-1!==b)&&(a.addEventListener("change",F),a.addEventListener("move",F),V.push(a),F(),!0)},getLightSources:function getLightSources(){return V},removeLightSource:function(a){var b=V.indexOf(a);return-1!==b&&(a.removeEventListener("change",F),a.removeEventListener("move",F),V.splice(b,1),F(),!0)},canRotate:function canRotate(){return S},canPan:function canPan(){return T},canZoom:function canZoom(){return U},enableRotate:function enableRotate(){return S=!0},enablePan:function enablePan(){return T=!0},enableZoom:function enableZoom(){return U=!0},disableRotate:function disableRotate(){return S=!1},disablePan:function disablePan(){return T=!1},disableZoom:function disableZoom(){return U=!1},isAttached:function isAttached(){return K},getRotationX:function getRotationX(){return O.x},getRotationY:function getRotationY(){return O.y},getRotationZ:function getRotationZ(){return O.z},rotateX:function rotateX(a){return b("x",a)},rotateY:function rotateY(a){return b("y",a)},rotateZ:function rotateZ(a){return b("z",a)},setRotationX:function setRotationX(a){return c("x",a)},setRotationY:function setRotationY(a){return c("y",a)},setRotationZ:function setRotationZ(a){return c("z",a)},panX:function panX(a){return l("x",a)},panY:function panY(a){return l("y",a)},panZ:function panZ(a){return l("z",a)},setPanX:function setPanX(a){return m("x",a)},setPanY:function setPanY(a){return m("y",a)},setPanZ:function setPanZ(a){return m("z",a)},getElement:function getElement(){return H},getParentElement:function getParentElement(){return G},getInteractionState:function getInteractionState(a){return a?R[a]:R},bind:function bind(){v(),w()},unbind:function unbind(){A(),B()}});(function(){H=document.createElement("div"),I=document.createElement("div"),J=document.createElement("div"),H.setAttribute("class","voxelcss-scene"),I.setAttribute("class","zoom"),J.setAttribute("class","camera"),H.appendChild(I),I.appendChild(J)})(),v(),w()}},{"./common":10,"./eventListener":11}],8:[function(b,c){"use strict";function d(){var G=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[0,0,0],H=1<arguments.length&&arguments[1]!==void 0?arguments[1]:x,I=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},J=void 0,K=void 0,L=void 0,M=void 0,N={},O=0,P=e(t(s(this)),{clone:function(){return new d([P.getPositionX(),P.getPositionY(),P.getPositionZ()],O,{mesh:M})},animUp:function(a){if(a)L=a,K.setAttribute("class","animated-up"),b();else throw"Scene required to add voxel to scene"},animDown:function(a){if(a)L=a,K.setAttribute("class","animated-down"),b();else throw"Scene required to add voxel to scene"},addToScene:function(a){if(a)L=a,K.setAttribute("class","animated"),b();else throw"Scene required to add voxel to scene"},removeFromScene:function(){L&&L.remove(P)},setParentScene:function(a){L=a},removeParentScene:function(){L=void 0},setDimension:c,getDimension:n,updateLightSource:function(a){var b=function(a){return l(a,3)},c=1,d=1,e=1,g=1,h=1,m=1;a.forEach(function(a){var f=[a.getPositionX(),a.getPositionY(),a.getPositionZ()],n=a.getBrightness(),o=a.getTravelDistance(),p=n[1]-n[0],q=1-n[1],r=function(a){var c=_slicedToArray(a,3),d=c[0],e=c[1],g=c[2],h=z(f,{A:d,B:e,C:g}),i=h.angle,m=h.direction,n=h.distance,r=0>m?1:j(1,b(1-i/(k/2))+l(n/o,6));return 1-(r*p+q)};d=i(0,d-r([0,0,-1])),c=i(0,c-r([0,0,1])),e=i(0,e-r([-1,0,0])),g=i(0,g-r([1,0,0])),h=i(0,h-r([0,1,0])),m=i(0,m-r([0,-1,0]))});var n={front:c,back:d,left:e,right:g,top:h,bottom:m};f(n).forEach(function(a){N[a].shader.style.opacity=n[a]})},setMesh:a,getMesh:function getMesh(){return M},getDomElement:function getDomElement(){return J},getAnimatedElement:function getAnimatedElement(){return K}});function a(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};if(a.constructor===u){var b=M;b&&b.removeEventListener("change",E),M=a,M.addEventListener("change",E),A()}}function b(){L.add(P)}function c(a){p(a)&&(O=a)}function n(){return O}function z(a,b){var c=L.getRotationX(),d=L.getRotationY(),e=L.getRotationZ(),f=o(c,-d,e),i=b.A,j=b.B,k=b.C,p=D(a,f);p={x:p.x-P.getPositionX()-i*n()/2,y:p.y-P.getPositionY()-j*n()/2,z:p.z-P.getPositionZ()-k*n()/2};var q=p,r=q.x,s=q.y,t=q.z,u=m(l(r,2)+l(s,2)+l(t,2)),v=1===g(k)?k*t:1===g(j)?j*s:i*r,w=h(g(r*i+s*j+t*k)/u);return{angle:w,direction:v,distance:u}}function D(a,b){var c=_slicedToArray(a,3),d=c[0],e=c[1],f=c[2],g=r(b,[[d],[e],[f]]);return{x:g[0][0],y:g[1][0],z:g[2][0]}}function A(){var a=M.getFaces();y.forEach(function(b){var c=a[b],d=N[b];if(c instanceof v&&(d.src=c.getSource(),d.removeAttribute("class")),c instanceof w){var e=d.parentElement;e.style.background="#"+c.getHex(),d.setAttribute("class","colored")}})}function B(a){var b=function(a){return a+"px"},c=O/2,d=P,f=C("img",""),g=C("div","shader"),h=C("div","voxelcss-face "+a);N[a]=e(f,{shader:g}),e(h.style,{width:b(O),height:b(O),marginLeft:b(-1*c),marginTop:b(-1*c),transform:{top:"rotateX(90deg) translateZ("+c+"px)",bottom:"rotateX(90deg) translateZ(-"+c+"px)",left:"rotateY(90deg) translateZ(-"+c+"px)",right:"rotateY(90deg) translateZ("+c+"px)",front:"translateZ("+c+"px)",back:"translateZ(-"+c+"px)"}[a]}),h.addEventListener("click",{top:function top(){return P.triggerEvent("TopClick",{target:d})},bottom:function bottom(){return P.triggerEvent("BottomClick",{target:d})},left:function left(){return P.triggerEvent("LeftClick",{target:d})},right:function right(){return P.triggerEvent("RightClick",{target:d})},front:function front(){return P.triggerEvent("FrontClick",{target:d})},back:function back(){return P.triggerEvent("BackClick",{target:d})}}[a]),h.addEventListener("contextmenu",F),h.appendChild(f),h.appendChild(g),K.appendChild(h)}function C(a,b){var c=document.createElement(a);return c.setAttribute("class",b),c}function E(){A();P.triggerEvent("MeshChange",{target:P,mesh:M})}function F(a){a.preventDefault();return P.triggerEvent("VoxelClick",{target:P}),!1}P.addEventListener("move",function(){var a=P.getPosition(),b=a.x,c=a.y,d=a.z;J.style.transform="translate3d("+b+"px, "+-c+"px, "+d+"px)"}),c(H),function(){J=C("div","voxelcss-cube"),K=C("div","animated"),y.forEach(function(a){return B(a)}),J.appendChild(K)}(),P.setPosition(G),a(q(I.mesh)?new u:I.mesh)}var e=Object.assign,f=Object.keys,g=Math.abs,h=Math.asin,i=Math.max,j=Math.min,k=a,l=Math.pow,m=Math.sqrt,n=b("./common"),o=n.generateRotationMatrix,p=n.isNumber,q=n.isUndefined,r=n.multiplyMatrices,s=b("./eventListener"),t=b("./positioned"),u=b("./Mesh"),v=b("./ImageFace"),w=b("./ColorFace"),x=50,y=["top","bottom","front","back","left","right"];c.exports=d},{"./ColorFace":2,"./ImageFace":4,"./Mesh":6,"./common":10,"./eventListener":11,"./positioned":14}],9:[function(a,b){"use strict";var c=Object.assign,d=a("./Mesh"),e=a("./Voxel");b.exports=function(a,b){function f(b){return l.push(b),a.add(b)}function g(b){var c=l.indexOf(b),d=-1<c;return d&&(a.remove(b),l.splice(c,1)),d}function h(){for(;0<l.length;)g(l[0])}function i(){return JSON.stringify(l.map(function(a){return k(a)}))}function j(a){if("string"==typeof a)try{h(),JSON.parse(a).forEach(function(a){var b=a.dimension,c=a.mesh,g=a.position,h=g.x,i=g.y,j=g.z,k=new e([h,i,j],b);k.setMesh(d.loadFromSerial(c)),f(k)})}catch(a){throw"Cannot import voxel data"}else throw"Only serialized data can be imported"}function k(a){return{position:a.getPosition(),dimension:a.getDimension(),mesh:a.getMesh().serialize()}}if(a===void 0)throw"World cannot be instantiated without a Scene instance";var l=[],m=function(){return"savedWorld<"+(b||"*")+">"};c(this,{add:f,remove:g,clear:h,getScene:function getScene(){return a},getVoxels:function getVoxels(){return l},import:j,export:i,load:function load(){return j(localStorage.getItem(m())||"[]")},isSaved:function isSaved(){return!!localStorage.getItem(m())},save:function save(){return localStorage.setItem(m(),i())},deleteSave:function deleteSave(){return localStorage.setItem(m(),"")}})}},{"./Mesh":6,"./Voxel":8}],10:[function(a,b){"use strict";function c(d,a){for(var b=d.length,e=d[0].length,f=a[0].length,g=Array(b),h=0;h<b;++h){g[h]=Array(f);for(var j=0;j<f;++j){g[h][j]=0;for(var c=0;c<e;++c)g[h][j]+=d[h][c]*a[c][j]}}return g}var d=Math.cos,e=Math.sin,f=16,g=16,h=function(a){return"number"==typeof a};b.exports={findKeyWithValue:function(a,b){var c=Object.keys(a),d=c.map(function(c,d){return a[c]===b&&d}).find(h);return c[d]},generateRotationMatrix:function(a,b,f){var g=[[1,0,0],[0,d(a),-e(a)],[0,e(a),d(a)]],h=[[d(b),0,e(b)],[0,1,0],[-e(b),0,d(b)]],i=[[d(f),-e(f),0],[e(f),d(f),0],[0,0,1]];return c(c(i,h),g)},hexToRgb:function(a){var b=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(b,function(a,c,d,e){return c+c+d+d+e+e});var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return c?{r:parseInt(c[1],f),g:parseInt(c[2],f),b:parseInt(c[3],f)}:null},isNumber:h,isShiftKey:function isShiftKey(a){return a.keyCode===g||a.which===g},isUndefined:function isUndefined(a){return a===void 0},mapValues:function(a,b){return Object.keys(a).map(function(c){return _defineProperty({},c,b(a[c]))}).reduce(function(a,b){return Object.assign(a,b)},{})},not:function(a){return function(){return!a.apply(void 0,arguments)}},multiplyMatrices:c,rgbToHex:function(a){var c=a.r,d=a.g,e=a.b;return""+(16777216+(c<<16)+(d<<8)+e).toString(16).slice(1)},constant:function constant(a){return function(){return a}},identity:function identity(a){return a}}},{}],11:[function(a,b){"use strict";var c=Object.assign,d=Array.isArray;b.exports=function(a){var b={},e=c(a||new Function,{addEventListener:function(a,c){(a="on"+a,"function"==typeof c)&&(b[a]||(b[a]=[]),-1<b[a].indexOf(c)||b[a].push(c))},removeEventListener:function(a,c){a="on"+a;var e=b[a];d(e)&&e.splice(e.indexOf(c),1)},triggerEvent:function(a,c){a="on"+a;var e=b[a];d(e)&&e.forEach(function(a){return a(c)})}});return e}},{}],12:[function(a,b){"use strict";a("../dist/voxelcss.css");var c=a("./ColorFace"),d=a("./Editor"),e=a("./eventListener"),f=a("./ImageFace"),g=a("./LightSource"),h=a("./Mesh"),i=a("./meshes"),j=a("./positioned"),k=a("./Scene"),l=a("./Voxel"),m=a("./World");b.exports={ColorFace:c,Editor:d,eventListener:e,ImageFace:f,LightSource:g,Mesh:h,meshes:i,Positioned:j,Scene:k,Voxel:l,World:m}},{"../dist/voxelcss.css":1,"./ColorFace":2,"./Editor":3,"./ImageFace":4,"./LightSource":5,"./Mesh":6,"./Scene":7,"./Voxel":8,"./World":9,"./eventListener":11,"./meshes":13,"./positioned":14}],13:[function(a,b){"use strict";var c=a("./Mesh"),d=a("./ImageFace");b.exports={dirt:new c(new d("http://voxelcss.com/res/dirt/main.png")),grass:new c({top:new d("http://voxelcss.com/res/grass/top.png"),bottom:new d("http://voxelcss.com/res/grass/bottom.png"),front:new d("http://voxelcss.com/res/grass/side.png"),back:new d("http://voxelcss.com/res/grass/side.png"),left:new d("http://voxelcss.com/res/grass/side.png"),right:new d("http://voxelcss.com/res/grass/side.png")}),water:new c(new d("http://voxelcss.com/res/water/main.png")),waterFall:new c({top:new d("http://voxelcss.com/res/water/main.png"),bottom:new d("http://voxelcss.com/res/water/main.png"),front:new d("http://voxelcss.com/res/water/fall.png"),back:new d("http://voxelcss.com/res/water/fall.png"),left:new d("http://voxelcss.com/res/water/fall.png"),right:new d("http://voxelcss.com/res/water/fall.png")}),waterFallTop:new c({top:new d("http://voxelcss.com/res/water/main.png"),bottom:new d("http://voxelcss.com/res/water/main.png"),front:new d("http://voxelcss.com/res/water/falltop.png"),back:new d("http://voxelcss.com/res/water/falltop.png"),left:new d("http://voxelcss.com/res/water/falltop.png"),right:new d("http://voxelcss.com/res/water/falltop.png")}),waterFallCrash:new c({top:new d("http://voxelcss.com/res/water/main.png"),bottom:new d("http://voxelcss.com/res/water/main.png"),front:new d("http://voxelcss.com/res/water/crash.png"),back:new d("http://voxelcss.com/res/water/crash.png"),left:new d("http://voxelcss.com/res/water/crash.png"),right:new d("http://voxelcss.com/res/water/crash.png")}),treeTrunk:new c({top:new d("http://voxelcss.com/res/tree/rings.png"),bottom:new d("http://voxelcss.com/res/tree/rings.png"),front:new d("http://voxelcss.com/res/tree/bark.png"),back:new d("http://voxelcss.com/res/tree/bark.png"),left:new d("http://voxelcss.com/res/tree/bark.png"),right:new d("http://voxelcss.com/res/tree/bark.png")}),treeLeaves:new c(new d("http://voxelcss.com/res/tree/leaves.png"))}},{"./ImageFace":4,"./Mesh":6}],14:[function(a,b){"use strict";var c=a("./common"),d=c.isNumber;b.exports=function(a){function b(a){return d(a)?void(j.x=a,k&&i.triggerEvent("move")):j.x}function c(a){return d(a)?void(j.y=a,k&&i.triggerEvent("move")):j.y}function e(a){return d(a)?void(j.z=a,k&&i.triggerEvent("move")):j.z}function f(a){return d(a)?b(a+j.x):j.x}function g(a){return d(a)?c(a+j.y):j.y}function h(a){return d(a)?e(a+j.z):j.z}var i=a||new Function,j={x:0,y:0,z:0},k=!0;return Object.assign(i,{setPosition:function(a){var d=_slicedToArray(a,3),f=d[0],g=d[1],h=d[2];return k=!1,b(f),c(g),e(h),k=!0,i.triggerEvent("move"),i},setPositionX:b,setPositionY:c,setPositionZ:e,getPosition:function(){return j},getPositionX:function(){return j.x},getPositionY:function(){return j.y},getPositionZ:function(){return j.z},translate:function(a,b,c){return k=!1,f(a),g(b),h(c),k=!0,i.triggerEvent("move"),i},translateX:f,translateY:g,translateZ:h}),i}},{"./common":10}],15:[function(a,b){"use strict";var c=[],d=function(a,b){var d=document.head||document.getElementsByTagName("head")[0],e=c[c.length-1];if(b=b||{},b.insertAt=b.insertAt||"bottom","top"===b.insertAt)e?e.nextSibling?d.insertBefore(a,e.nextSibling):d.appendChild(a):d.insertBefore(a,d.firstChild),c.push(a);else if("bottom"===b.insertAt)d.appendChild(a);else throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.")};b.exports={createLink:function createLink(a,b){var c=document.head||document.getElementsByTagName("head")[0],d=document.createElement("link");for(var e in d.href=a,d.rel="stylesheet",b)if(b.hasOwnProperty(e)){var f=b[e];d.setAttribute("data-"+e,f)}c.appendChild(d)},createStyle:function createStyle(a,b,c){c=c||{};var e=document.createElement("style");for(var f in e.type="text/css",b)if(b.hasOwnProperty(f)){var g=b[f];e.setAttribute("data-"+f,g)}e.sheet?(e.innerHTML=a,e.sheet.cssText=a,d(e,{insertAt:c.insertAt})):e.styleSheet?(d(e,{insertAt:c.insertAt}),e.styleSheet.cssText=a):(e.appendChild(document.createTextNode(a)),d(e,{insertAt:c.insertAt}))}}},{}]},{},[12])(12)});
