<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>World.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-core_Voxel-Voxel.html">Voxel</a></span></li><li class="nav-heading">Modules</li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-core_ColorFace.html">core/ColorFace</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-core_Editor.html">core/Editor</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-core_ImageFace.html">core/ImageFace</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-core_LightSource.html">core/LightSource</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-core_Mesh.html">core/Mesh</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-core_Scene.html">core/Scene</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-core_Voxel.html">core/Voxel</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-core_World.html">core/World</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-eventListener.html">eventListener</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-meshes.html">meshes</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-positioned.html">positioned</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">World.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file World module
 * @description A World can save the state of any voxels added to it
 * @requires core/Mesh
 * @requires core/Voxel
 * @module core/World
 * @example &lt;caption>Add a scene to a world&lt;/caption>
 * const Voxelcss = require('voxelcss');
 * let scene = new Voxelcss.Scene();
 * let world = new Voxelcss.World(scene);
**/
'use strict';

const Mesh = require('./Mesh');
const Voxel = require('./Voxel');

module.exports = World;

function World() {
    var self = this;
    var undefined;
    var scene;
    var worldLabel = '*';
    var voxels = [];
    self.add = addVoxel;
    self.remove = removeVoxel;
    self.export = exportVoxel;
    self.import = importVoxel;
    self.save = saveToBrowser;
    self.load = loadFromBrowser;
    self.isSaved = isSavedToBrowser;
    self.deleteSave = deleteSave;
    self.getScene = getScene;
    self.getVoxels = getVoxels;
    function addVoxel(voxel) {
        voxels.push(voxel);
        return scene.add(voxel);
    }
    function removeVoxel(voxel) {
        var index = voxels.indexOf(voxel);
        if (index &lt; 0) {
            return false;
        }
        scene.remove(voxel);
        voxels.splice(index, 1);
        return true;
    }
    function exportVoxel() {
        var json = [];
        for (var i = 0, voxel; voxel = voxels[i++];) {
            json.push({
                position: voxel.getPosition(),
                dimension: voxel.getDimension(),
                mesh: voxel.getMesh().serialize()
            });
        }
        return JSON.stringify(json);
    }
    function importVoxel(string) {
        clearBlocks();
        var json = JSON.parse(string + '');
        for (var i = 0, serial; serial = json[i++];) {
            var voxel = new Voxel(serial.position.x, serial.position.y, serial.position.z, serial.dimension);
            voxel.setMesh(Mesh.loadFromSerial(serial.mesh));
            addVoxel(voxel);
        }
    }
    function saveToBrowser() {
        localStorage.setItem(formSaveName(), exportVoxel());
    }
    function loadFromBrowser() {
        importVoxel(localStorage.getItem(formSaveName()) || '[]');
    }
    function isSavedToBrowser() {
        return !!localStorage.getItem(formSaveName());
    }
    function deleteSave() {
        localStorage.setItem(formSaveName(), '');
    }
    function getScene() {
        return scene;
    }
    function getVoxels() {
        return voxels.concat([]);
    }
    function clearBlocks() {
        while (voxels.length > 0) {removeVoxel(voxels[0]);}
    }
    function formSaveName() {
        return 'savedWorld&lt;' + worldLabel + '>';
    }
    (function Constructor(_scene, _worldLabel) {
        if (_scene === undefined) {throw 'World cannot be instantiated without a Scene instance';}
        scene = _scene;
        if (_worldLabel !== undefined) {worldLabel = _worldLabel;}
    }).apply(self, arguments);
}
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.3</a> on Thu Jul 20 2017 19:13:28 GMT-0500 (CDT) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
